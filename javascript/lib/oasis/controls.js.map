{"version":3,"file":"module.js","sources":["../src/FreeControl.ts","../src/OrbitControl.ts"],"sourcesContent":["import { Entity, MathUtil, Script, Spherical, Vector3 } from \"oasis-engine\";\n\n// Prevent universal lock.\nconst ESP = MathUtil.zeroTolerance;\n\nfunction includes(array, ...filterArray) {\n  return filterArray.some((e) => array.indexOf(e) !== -1);\n}\n\n/**\n * The camera's roaming controller, can move up and down, left and right, and rotate the viewing angle.\n */\nexport class FreeControl extends Script {\n  _forward = new Vector3();\n  _right = new Vector3();\n  camera: Entity;\n  mainElement: any;\n  domElement: any;\n\n  /**\n   * Movement distance per second, the unit is the unit before MVP conversion.\n   */\n  movementSpeed: number;\n\n  /**\n   * Rotate speed.\n   */\n  rotateSpeed: number;\n\n  /**\n   * Simulate a ground.\n   */\n  floorMock: boolean;\n\n  /**\n   * Simulated ground height.\n   */\n  floorY: number;\n\n  /**\n   * Only rotate when press=true\n   */\n  press: boolean;\n  keysForward: Array<string | number>;\n  keysBackward: Array<string | number>;\n  keysLeft: Array<string | number>;\n  keysRight: Array<string | number>;\n\n  /**\n   * Radian of spherical.theta.\n   */\n  private _theta: number;\n\n  /**\n   * Radian of spherical.phi.\n   */\n  private _phi: number;\n\n  private _moveForward: boolean;\n  private _moveBackward: boolean;\n  private _moveLeft: boolean;\n  private _moveRight: boolean;\n\n  private _v3Cache: Vector3;\n  private _spherical: Spherical;\n  private _rotateOri: Array<number>;\n  private _events: Array<{ type: string; listener: () => {}; element?: any }>;\n\n  constructor(entity: Entity) {\n    super(entity);\n    this.camera = entity;\n    // @ts-ignore\n    // @todo In the future, the dependence on html elements will be removed and realized through the input of the packaging engine.\n    this.mainElement = this.scene.engine.canvas._webCanvas;\n    this.domElement = document;\n\n    this.movementSpeed = 1.0;\n    this.rotateSpeed = 1.0;\n\n    this.floorMock = true;\n    this.floorY = 0;\n\n    this.press = false;\n\n    this.keysForward = [\"KeyW\", \"ArrowUp\"];\n    this.keysBackward = [\"KeyS\", \"ArrowDown\"];\n    this.keysLeft = [\"KeyA\", \"ArrowLeft\"];\n    this.keysRight = [\"KeyD\", \"ArrowRight\"];\n\n    this._theta = 0;\n    this._phi = 0;\n\n    // private variables\n    this._moveForward = false;\n    this._moveBackward = false;\n    this._moveLeft = false;\n    this._moveRight = false;\n\n    this._v3Cache = new Vector3();\n    this._spherical = new Spherical();\n    this._rotateOri = [0, 0];\n\n    this._events = [\n      { type: \"mousemove\", listener: this.onMouseMove.bind(this) },\n      { type: \"touchmove\", listener: this.onMouseMove.bind(this) },\n      { type: \"mousedown\", listener: this.onMouseDown.bind(this) },\n      { type: \"touchstart\", listener: this.onMouseDown.bind(this) },\n      { type: \"mouseup\", listener: this.onMouseUp.bind(this) },\n      { type: \"touchend\", listener: this.onMouseUp.bind(this) },\n      { type: \"keydown\", listener: this.onKeyDown.bind(this), element: window },\n      { type: \"keyup\", listener: this.onKeyUp.bind(this), element: window },\n      { type: \"contextmenu\", listener: this.onContextMenu.bind(this) }\n    ];\n\n    this.initEvents();\n\n    // init spherical\n    this.updateSpherical();\n  }\n\n  /**\n   * Browser right click event.\n   */\n  onContextMenu(event): void {\n    event.preventDefault();\n  }\n\n  /**\n   * Keyboard press event.\n   */\n  onKeyDown(event): void {\n    const { code, key, keyCode } = event;\n    if (includes(this.keysForward, code, key, keyCode)) {\n      this._moveForward = true;\n    } else if (includes(this.keysBackward, code, key, keyCode)) {\n      this._moveBackward = true;\n    } else if (includes(this.keysLeft, code, key, keyCode)) {\n      this._moveLeft = true;\n    } else if (includes(this.keysRight, code, key, keyCode)) {\n      this._moveRight = true;\n    }\n  }\n\n  /**\n   * Keyboard up event.\n   */\n  onKeyUp(event): void {\n    const { code, key, keyCode } = event;\n    if (includes(this.keysForward, code, key, keyCode)) {\n      this._moveForward = false;\n    } else if (includes(this.keysBackward, code, key, keyCode)) {\n      this._moveBackward = false;\n    } else if (includes(this.keysLeft, code, key, keyCode)) {\n      this._moveLeft = false;\n    } else if (includes(this.keysRight, code, key, keyCode)) {\n      this._moveRight = false;\n    }\n  }\n\n  /**\n   * Mouse press event.\n   */\n  onMouseDown(event): void {\n    event.stopPropagation();\n    event = (event.changedTouches && event.changedTouches[0]) || event;\n\n    if (this.domElement !== document) {\n      this.domElement.focus();\n    }\n\n    this.press = true;\n    this._rotateOri = [event.clientX, event.clientY];\n  }\n\n  /**\n   * Mouse up event.\n   */\n  onMouseUp(event): void {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.press = false;\n  }\n\n  /**\n   * Mouse movement event.\n   */\n  onMouseMove(event): void {\n    if (this.press === false) return;\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n    event.stopPropagation();\n    event = (event.changedTouches && event.changedTouches[0]) || event;\n\n    const movementX = event.clientX - this._rotateOri[0];\n    const movementY = event.clientY - this._rotateOri[1];\n    this._rotateOri[0] = event.clientX;\n    this._rotateOri[1] = event.clientY;\n    const factorX = 180 / this.mainElement.width;\n    const factorY = 180 / this.mainElement.height;\n    const actualX = movementX * factorX;\n    const actualY = movementY * factorY;\n\n    this.rotate(-actualX, actualY);\n  }\n\n  /**\n   * The angle of rotation around the y axis and the x axis respectively.\n   * @param alpha - Radian to rotate around the y axis\n   * @param beta - Radian to rotate around the x axis\n   */\n  rotate(alpha: number = 0, beta: number = 0): void {\n    this._theta += MathUtil.degreeToRadian(alpha);\n    this._phi += MathUtil.degreeToRadian(beta);\n    this._phi = MathUtil.clamp(this._phi, ESP, Math.PI - ESP);\n    this._spherical.theta = this._theta;\n    this._spherical.phi = this._phi;\n    this._spherical.setToVec3(this._v3Cache);\n    Vector3.add(this.camera.transform.position, this._v3Cache, this._v3Cache);\n    this.camera.transform.lookAt(this._v3Cache, new Vector3(0, 1, 0));\n  }\n\n  onUpdate(delta: number): void {\n    if (this.enabled === false) return;\n\n    const actualMoveSpeed = (delta / 1000) * this.movementSpeed;\n    this.camera.transform.getWorldForward(this._forward);\n    this.camera.transform.getWorldRight(this._right);\n    if (this._moveForward) {\n      this.camera.transform.translate(this._forward.scale(actualMoveSpeed));\n    }\n    if (this._moveBackward) {\n      this.camera.transform.translate(this._forward.scale(-actualMoveSpeed));\n    }\n    if (this._moveLeft) {\n      this.camera.transform.translate(this._right.scale(-actualMoveSpeed));\n    }\n    if (this._moveRight) {\n      this.camera.transform.translate(this._right.scale(actualMoveSpeed));\n    }\n\n    if (this.floorMock) {\n      const position = this.camera.transform.position;\n      if (position.y !== this.floorY) {\n        this.camera.transform.setPosition(position.x, this.floorY, position.z);\n      }\n    }\n  }\n\n  /**\n   * Register browser events.\n   */\n  initEvents(): void {\n    this._events.forEach((ele) => {\n      if (ele.element) {\n        ele.element.addEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.addEventListener(ele.type, ele.listener, false);\n      }\n    });\n  }\n\n  onDestroy(): void {\n    this._events.forEach((ele) => {\n      if (ele.element) {\n        ele.element.removeEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.removeEventListener(ele.type, ele.listener, false);\n      }\n    });\n  }\n\n  /**\n   * must updateSpherical after quaternion has been changed\n   * @example\n   * Entity#lookAt([0,1,0],[0,1,0]);\n   * AFreeControls#updateSpherical();\n   */\n  updateSpherical(): void {\n    this._v3Cache.setValue(0, 0, -1);\n    Vector3.transformByQuat(this._v3Cache, this.camera.rotation, this._v3Cache);\n    this._spherical.setFromVec3(this._v3Cache);\n    this._theta = this._spherical.theta;\n    this._phi = this._spherical.phi;\n  }\n}\n","\"use strict\";\nimport { Entity, Matrix, Script, Spherical, Vector2, Vector3 } from \"oasis-engine\";\n\n/**\n * The camera's track controller, can rotate, zoom, pan, support mouse and touch events.\n */\nexport class OrbitControl extends Script {\n  camera: Entity;\n  domElement: HTMLElement | Document;\n  mainElement: HTMLCanvasElement;\n  fov: number;\n  target: Vector3;\n  up: Vector3;\n  minDistance: number;\n  maxDistance: number;\n  minZoom: number;\n  maxZoom: number;\n  enableDamping: boolean;\n  zoomFactor: number;\n  enableRotate: boolean;\n  keyPanSpeed: number;\n  minPolarAngle: number;\n  maxPolarAngle: number;\n  minAzimuthAngle: number;\n  maxAzimuthAngle: number;\n  enableZoom: boolean;\n  dampingFactor: number;\n  zoomSpeed: number;\n  enablePan: boolean;\n  autoRotate: boolean;\n  autoRotateSpeed: number;\n  rotateSpeed: number;\n  enableKeys: boolean;\n  keys: { LEFT: number; RIGHT: number; UP: number; BOTTOM: number };\n  mouseButtons: { ORBIT: number; ZOOM: number; PAN: number };\n  touchFingers: { ORBIT: number; ZOOM: number; PAN: number };\n  STATE: {\n    TOUCH_ROTATE: number;\n    ROTATE: number;\n    TOUCH_PAN: number;\n    ZOOM: number;\n    NONE: number;\n    PAN: number;\n    TOUCH_ZOOM: number;\n  };\n  mouseUpEvents: { listener: any; type: string }[];\n  constEvents: { listener: any; type: string; element?: Window }[];\n\n  private _position: Vector3;\n  private _offset: Vector3;\n  private _spherical: Spherical;\n  private _sphericalDelta: Spherical;\n  private _sphericalDump: Spherical;\n  private _zoomFrag: number;\n  private _scale: number;\n  private _panOffset: Vector3;\n  private _isMouseUp: boolean;\n  private _vPan: Vector3;\n  private _state: any;\n  private _rotateStart: Vector2;\n  private _rotateEnd: Vector2;\n  private _rotateDelta: Vector2;\n  private _panStart: Vector2;\n  private _panEnd: Vector2;\n  private _panDelta: Vector2;\n  private _zoomStart: Vector2;\n  private _zoomEnd: Vector2;\n  private _zoomDelta: Vector2;\n  private _oriTarget = new Vector3(Infinity, Infinity, Infinity);\n\n  constructor(entity: Entity) {\n    super(entity);\n\n    this.camera = entity;\n    // @ts-ignore\n    // @todo In the future, the dependence on html elements will be removed and realized through the input of the packaging engine.\n    this.mainElement = this.engine.canvas._webCanvas;\n    this.domElement = document;\n    this.fov = 45;\n\n    // Target position.\n    this.target = new Vector3();\n\n    // Up vector\n    this.up = new Vector3(0, 1, 0);\n\n    /**\n     * The minimum distance, the default is 0.1, should be greater than 0.\n     */\n    this.minDistance = 0.1;\n    /**\n     * The maximum distance, the default is infinite, should be greater than the minimum distance\n     */\n    this.maxDistance = Infinity;\n\n    /**\n     * Minimum zoom speed, the default is 0.0.\n     * @member {Number}\n     */\n    this.minZoom = 0.0;\n\n    /**\n     * Maximum zoom speed, the default is positive infinity.\n     */\n    this.maxZoom = Infinity;\n\n    /**\n     * The minimum radian in the vertical direction, the default is 0 radian, the value range is 0 - Math.PI.\n     */\n    this.minPolarAngle = 0;\n\n    /**\n     * The maximum radian in the vertical direction, the default is Math.PI, and the value range is 0 - Math.PI.\n     */\n    this.maxPolarAngle = Math.PI;\n\n    /**\n     * The minimum radian in the horizontal direction, the default is negative infinity.\n     */\n    this.minAzimuthAngle = -Infinity;\n\n    /**\n     * The maximum radian in the horizontal direction, the default is positive infinity.\n     */\n    this.maxAzimuthAngle = Infinity;\n\n    /**\n     * Whether to enable camera damping, the default is true.\n     */\n    this.enableDamping = true;\n\n    /**\n     * Rotation damping parameter, default is 0.1 .\n     */\n    this.dampingFactor = 0.1;\n\n    /**\n     * Zoom damping parameter, default is 0.2 .\n     */\n    this.zoomFactor = 0.2;\n\n    /**\n     * Whether to enable zoom, the default is true.\n     */\n    this.enableZoom = true;\n\n    /**\n     * Camera zoom speed, the default is 1.0.\n     */\n    this.zoomSpeed = 1.0;\n\n    /**\n     * Whether to enable rotation, the default is true.\n     */\n    this.enableRotate = true;\n\n    /**\n     * Rotation speed, default is 1.0 .\n     */\n    this.rotateSpeed = 1.0;\n\n    /**\n     * Whether to enable translation, the default is true.\n     */\n    this.enablePan = true;\n\n    /**\n     * Keyboard translation speed, the default is 7.0 .\n     */\n    this.keyPanSpeed = 7.0;\n\n    /**\n     * Whether to automatically rotate the camera, the default is false.\n     */\n    this.autoRotate = false;\n\n    /**\n     * The time required for one automatic rotation, the default is 2.0s .\n     */\n    this.autoRotateSpeed = 2.0;\n\n    /**\n     * Whether to enable keyboard.\n     */\n    this.enableKeys = false;\n    this.keys = {\n      LEFT: 37,\n      UP: 38,\n      RIGHT: 39,\n      BOTTOM: 40\n    };\n\n    // Control keys.\n    this.mouseButtons = {\n      ORBIT: 0,\n      ZOOM: 1,\n      PAN: 2\n    };\n\n    this.touchFingers = {\n      ORBIT: 1,\n      ZOOM: 2,\n      PAN: 3\n    };\n\n    // Reuse objects to prevent excessive stack allocation.\n    // update\n    this._position = new Vector3();\n    this._offset = new Vector3();\n    this._spherical = new Spherical();\n    this._sphericalDelta = new Spherical();\n    this._sphericalDump = new Spherical();\n    this._zoomFrag = 0;\n    this._scale = 1;\n    this._panOffset = new Vector3();\n    this._isMouseUp = true;\n\n    // pan\n    this._vPan = new Vector3();\n\n    // state\n    this._rotateStart = new Vector2();\n    this._rotateEnd = new Vector2();\n    this._rotateDelta = new Vector2();\n\n    this._panStart = new Vector2();\n    this._panEnd = new Vector2();\n    this._panDelta = new Vector2();\n\n    this._zoomStart = new Vector2();\n    this._zoomEnd = new Vector2();\n    this._zoomDelta = new Vector2();\n\n    this.STATE = {\n      NONE: -1,\n      ROTATE: 0,\n      ZOOM: 1,\n      PAN: 2,\n      TOUCH_ROTATE: 3,\n      TOUCH_ZOOM: 4,\n      TOUCH_PAN: 5\n    };\n    this._state = this.STATE.NONE;\n\n    this.constEvents = [\n      { type: \"mousedown\", listener: this.onMouseDown.bind(this) },\n      { type: \"wheel\", listener: this.onMouseWheel.bind(this) },\n      { type: \"keydown\", listener: this.onKeyDown.bind(this), element: window },\n      { type: \"touchstart\", listener: this.onTouchStart.bind(this) },\n      { type: \"touchmove\", listener: this.onTouchMove.bind(this) },\n      { type: \"touchend\", listener: this.onTouchEnd.bind(this) },\n      { type: \"contextmenu\", listener: this.onContextMenu.bind(this) }\n    ];\n\n    this.mouseUpEvents = [\n      { type: \"mousemove\", listener: this.onMouseMove.bind(this) },\n      { type: \"mouseup\", listener: this.onMouseUp.bind(this) }\n    ];\n\n    this.constEvents.forEach((ele) => {\n      if (ele.element) {\n        ele.element.addEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.addEventListener(ele.type, ele.listener, false);\n      }\n    });\n  }\n\n  onDisable(): void {\n    const element = this.domElement === document ? this.domElement.body : this.domElement;\n    this.mainElement.removeEventListener(this.mouseUpEvents[0].type, this.mouseUpEvents[0].listener, false);\n    element.removeEventListener(this.mouseUpEvents[1].type, this.mouseUpEvents[1].listener, false);\n  }\n\n  onDestroy() {\n    this.constEvents.forEach((ele) => {\n      if (ele.element) {\n        ele.element.removeEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.removeEventListener(ele.type, ele.listener, false);\n      }\n    });\n    const element = this.domElement === document ? this.domElement.body : this.domElement;\n    this.mainElement.removeEventListener(this.mouseUpEvents[0].type, this.mouseUpEvents[0].listener, false);\n    element.removeEventListener(this.mouseUpEvents[1].type, this.mouseUpEvents[1].listener, false);\n  }\n\n  onUpdate(dtime) {\n    if (!this.enabled) return;\n\n    const position: Vector3 = this.camera.transform.position;\n    position.cloneTo(this._offset);\n    this._offset.subtract(this.target);\n    this._spherical.setFromVec3(this._offset);\n\n    if (this.autoRotate && this._state === this.STATE.NONE) {\n      this.rotateLeft(this.getAutoRotationAngle(dtime));\n    }\n\n    this._spherical.theta += this._sphericalDelta.theta;\n    this._spherical.phi += this._sphericalDelta.phi;\n\n    this._spherical.theta = Math.max(this.minAzimuthAngle, Math.min(this.maxAzimuthAngle, this._spherical.theta));\n    this._spherical.phi = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, this._spherical.phi));\n    this._spherical.makeSafe();\n\n    if (this._scale !== 1) {\n      this._zoomFrag = this._spherical.radius * (this._scale - 1);\n    }\n\n    this._spherical.radius += this._zoomFrag;\n    this._spherical.radius = Math.max(this.minDistance, Math.min(this.maxDistance, this._spherical.radius));\n\n    this.target.add(this._panOffset);\n    this._spherical.setToVec3(this._offset);\n    this.target.cloneTo(this._position);\n    this._position.add(this._offset);\n\n    if (!Vector3.equals(this.camera.transform.position, this._position)) {\n      this.camera.transform.position = this._position;\n      this.camera.transform.lookAt(this.target, this.up);\n    }\n    if (!Vector3.equals(this.target, this._oriTarget)) {\n      this.camera.transform.lookAt(this.target, this.up);\n      this.target.cloneTo(this._oriTarget);\n    }\n\n    if (this.enableDamping === true) {\n      this._sphericalDump.theta *= 1 - this.dampingFactor;\n      this._sphericalDump.phi *= 1 - this.dampingFactor;\n      this._zoomFrag *= 1 - this.zoomFactor;\n\n      if (this._isMouseUp) {\n        this._sphericalDelta.theta = this._sphericalDump.theta;\n        this._sphericalDelta.phi = this._sphericalDump.phi;\n      } else {\n        this._sphericalDelta.set(0, 0, 0);\n      }\n    } else {\n      this._sphericalDelta.set(0, 0, 0);\n      this._zoomFrag = 0;\n    }\n\n    this._scale = 1;\n    this._panOffset.setValue(0, 0, 0);\n  }\n\n  /**\n   * Get the radian of automatic rotation.\n   */\n  getAutoRotationAngle(dtime: number) {\n    return ((2 * Math.PI) / this.autoRotateSpeed / 1000) * dtime;\n  }\n\n  /**\n   * Get zoom value.\n   */\n  getZoomScale() {\n    return Math.pow(0.95, this.zoomSpeed);\n  }\n\n  /**\n   * Rotate to the left by a certain randian.\n   * @param radian - Radian value of rotation\n   */\n  rotateLeft(radian: number) {\n    this._sphericalDelta.theta -= radian;\n    if (this.enableDamping) {\n      this._sphericalDump.theta = -radian;\n    }\n  }\n\n  /**\n   * Rotate to the right by a certain randian.\n   * @param radian - Radian value of rotation\n   */\n  rotateUp(radian: number) {\n    this._sphericalDelta.phi -= radian;\n    if (this.enableDamping) {\n      this._sphericalDump.phi = -radian;\n    }\n  }\n\n  /**\n   * Pan left.\n   */\n  panLeft(distance: number, worldMatrix: Matrix) {\n    const e = worldMatrix.elements;\n    this._vPan.setValue(e[0], e[1], e[2]);\n    this._vPan.scale(distance);\n    this._panOffset.add(this._vPan);\n  }\n\n  /**\n   * Pan right.\n   */\n  panUp(distance: number, worldMatrix: Matrix) {\n    const e = worldMatrix.elements;\n    this._vPan.setValue(e[4], e[5], e[6]);\n    this._vPan.scale(distance);\n    this._panOffset.add(this._vPan);\n  }\n\n  /**\n   * Pan.\n   * @param deltaX - The amount of translation from the screen distance in the x direction\n   * @param deltaY - The amount of translation from the screen distance in the y direction\n   */\n  pan(deltaX: number, deltaY: number) {\n    const element = this.domElement === document ? this.domElement.body : (this.domElement as HTMLElement);\n\n    // perspective only\n    const position: Vector3 = this.camera.position;\n    position.cloneTo(this._vPan);\n    this._vPan.subtract(this.target);\n    let targetDistance = this._vPan.length();\n\n    targetDistance *= (this.fov / 2) * (Math.PI / 180);\n\n    this.panLeft(-2 * deltaX * (targetDistance / element.clientHeight), this.camera.transform.worldMatrix);\n    this.panUp(2 * deltaY * (targetDistance / element.clientHeight), this.camera.transform.worldMatrix);\n  }\n\n  /**\n   * Zoom in.\n   */\n  zoomIn(zoomScale: number): void {\n    // perspective only\n    this._scale *= zoomScale;\n  }\n\n  /**\n   * Zoom out.\n   */\n  zoomOut(zoomScale: number): void {\n    // perspective only\n    this._scale /= zoomScale;\n  }\n\n  /**\n   * Rotation parameter update on mouse click.\n   */\n  handleMouseDownRotate(event) {\n    this._rotateStart.setValue(event.clientX, event.clientY);\n  }\n\n  /**\n   * Zoom parameter update on mouse click.\n   */\n  handleMouseDownZoom(event) {\n    this._zoomStart.setValue(event.clientX, event.clientY);\n  }\n\n  /**\n   * Pan parameter update on mouse click.\n   */\n  handleMouseDownPan(event) {\n    this._panStart.setValue(event.clientX, event.clientY);\n  }\n\n  /**\n   * Rotation parameter update when the mouse moves.\n   */\n  handleMouseMoveRotate(event) {\n    this._rotateEnd.setValue(event.clientX, event.clientY);\n    Vector2.subtract(this._rotateEnd, this._rotateStart, this._rotateDelta);\n\n    const element = this.domElement === document ? document.body : (this.domElement as HTMLElement);\n\n    this.rotateLeft(2 * Math.PI * (this._rotateDelta.x / element.clientWidth) * this.rotateSpeed);\n    this.rotateUp(2 * Math.PI * (this._rotateDelta.y / element.clientHeight) * this.rotateSpeed);\n\n    this._rotateEnd.cloneTo(this._rotateStart);\n  }\n\n  /**\n   * Zoom parameters update when the mouse moves.\n   */\n  handleMouseMoveZoom(event) {\n    this._zoomEnd.setValue(event.clientX, event.clientY);\n    Vector2.subtract(this._zoomEnd, this._zoomStart, this._zoomDelta);\n\n    if (this._zoomDelta.y > 0) {\n      this.zoomOut(this.getZoomScale());\n    } else if (this._zoomDelta.y < 0) {\n      this.zoomIn(this.getZoomScale());\n    }\n\n    this._zoomEnd.cloneTo(this._zoomStart);\n  }\n\n  /**\n   * Pan parameters update when the mouse moves.\n   */\n  handleMouseMovePan(event: MouseEvent): void {\n    this._panEnd.setValue(event.clientX, event.clientY);\n    Vector2.subtract(this._panEnd, this._panStart, this._panDelta);\n\n    this.pan(this._panDelta.x, this._panDelta.y);\n\n    this._panEnd.cloneTo(this._panStart);\n  }\n\n  /**\n   * Zoom parameter update when the mouse wheel is scrolled.\n   */\n  handleMouseWheel(event: MouseWheelEvent): void {\n    if (event.deltaY < 0) {\n      this.zoomIn(this.getZoomScale());\n    } else if (event.deltaY > 0) {\n      this.zoomOut(this.getZoomScale());\n    }\n  }\n\n  /**\n   * Pan parameter update when keyboard is pressed.\n   */\n  handleKeyDown(event: KeyboardEvent) {\n    switch (event.keyCode) {\n      case this.keys.UP:\n        this.pan(0, this.keyPanSpeed);\n        break;\n      case this.keys.BOTTOM:\n        this.pan(0, -this.keyPanSpeed);\n        break;\n      case this.keys.LEFT:\n        this.pan(this.keyPanSpeed, 0);\n        break;\n      case this.keys.RIGHT:\n        this.pan(-this.keyPanSpeed, 0);\n        break;\n    }\n  }\n\n  /**\n   * Rotation parameter update when touch is dropped.\n   */\n  handleTouchStartRotate(event: TouchEvent) {\n    this._rotateStart.setValue(event.touches[0].pageX, event.touches[0].pageY);\n  }\n\n  /**\n   * Zoom parameter update when touch down.\n   */\n  handleTouchStartZoom(event: TouchEvent) {\n    const dx = event.touches[0].pageX - event.touches[1].pageX;\n    const dy = event.touches[0].pageY - event.touches[1].pageY;\n\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    this._zoomStart.setValue(0, distance);\n  }\n\n  /**\n   * Update the translation parameter when touch down.\n   */\n  handleTouchStartPan(event: TouchEvent) {\n    this._panStart.setValue(event.touches[0].pageX, event.touches[0].pageY);\n  }\n\n  /**\n   * Rotation parameter update when touch to move.\n   */\n  handleTouchMoveRotate(event: TouchEvent) {\n    this._rotateEnd.setValue(event.touches[0].pageX, event.touches[0].pageY);\n    Vector2.subtract(this._rotateEnd, this._rotateStart, this._rotateDelta);\n\n    const element = this.domElement === document ? this.domElement.body : (this.domElement as HTMLElement);\n\n    this.rotateLeft(((2 * Math.PI * this._rotateDelta.x) / element.clientWidth) * this.rotateSpeed);\n    this.rotateUp(((2 * Math.PI * this._rotateDelta.y) / element.clientHeight) * this.rotateSpeed);\n\n    this._rotateEnd.cloneTo(this._rotateStart);\n  }\n\n  /**\n   * Zoom parameter update when touch to move.\n   */\n  handleTouchMoveZoom(event) {\n    const dx = event.touches[0].pageX - event.touches[1].pageX;\n    const dy = event.touches[0].pageY - event.touches[1].pageY;\n\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    this._zoomEnd.setValue(0, distance);\n\n    Vector2.subtract(this._zoomEnd, this._zoomStart, this._zoomDelta);\n\n    if (this._zoomDelta.y > 0) {\n      this.zoomIn(this.getZoomScale());\n    } else if (this._zoomDelta.y < 0) {\n      this.zoomOut(this.getZoomScale());\n    }\n\n    this._zoomEnd.cloneTo(this._zoomStart);\n  }\n\n  /**\n   * Pan parameter update when touch moves.\n   */\n  handleTouchMovePan(event: TouchEvent) {\n    this._panEnd.setValue(event.touches[0].pageX, event.touches[0].pageY);\n\n    Vector2.subtract(this._panEnd, this._panStart, this._panDelta);\n\n    this.pan(this._panDelta.x, this._panDelta.y);\n\n    this._panEnd.cloneTo(this._panStart);\n  }\n\n  /**\n   * Total handling of mouse down events.\n   */\n  onMouseDown(event: MouseEvent) {\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n\n    this._isMouseUp = false;\n\n    switch (event.button) {\n      case this.mouseButtons.ORBIT:\n        if (this.enableRotate === false) return;\n\n        this.handleMouseDownRotate(event);\n        this._state = this.STATE.ROTATE;\n        break;\n\n      case this.mouseButtons.ZOOM:\n        if (this.enableZoom === false) return;\n\n        this.handleMouseDownZoom(event);\n        this._state = this.STATE.ZOOM;\n        break;\n\n      case this.mouseButtons.PAN:\n        if (this.enablePan === false) return;\n\n        this.handleMouseDownPan(event);\n        this._state = this.STATE.PAN;\n        break;\n    }\n\n    if (this._state !== this.STATE.NONE) {\n      const element = this.domElement === document ? this.domElement.body : this.domElement;\n      this.mainElement.addEventListener(this.mouseUpEvents[0].type, this.mouseUpEvents[0].listener, false);\n      element.addEventListener(this.mouseUpEvents[1].type, this.mouseUpEvents[1].listener, false);\n    }\n  }\n\n  /**\n   * Total handling of mouse movement events.\n   */\n  onMouseMove(event: MouseEvent) {\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n\n    switch (this._state) {\n      case this.STATE.ROTATE:\n        if (this.enableRotate === false) return;\n\n        this.handleMouseMoveRotate(event);\n        break;\n\n      case this.STATE.ZOOM:\n        if (this.enableZoom === false) return;\n\n        this.handleMouseMoveZoom(event);\n        break;\n\n      case this.STATE.PAN:\n        if (this.enablePan === false) return;\n\n        this.handleMouseMovePan(event);\n        break;\n    }\n  }\n\n  /**\n   * Total handling of mouse up events.\n   */\n  onMouseUp() {\n    if (this.enabled === false) return;\n\n    this._isMouseUp = true;\n\n    this.mouseUpEvents.forEach((ele) => {\n      const element = this.domElement === document ? this.domElement.body : this.domElement;\n      element.removeEventListener(ele.type, ele.listener, false);\n      this.mainElement.removeEventListener(ele.type, ele.listener, false);\n    });\n\n    this._state = this.STATE.NONE;\n  }\n\n  /**\n   * Total handling of mouse wheel events.\n   */\n  onMouseWheel(event: MouseWheelEvent) {\n    if (\n      this.enabled === false ||\n      this.enableZoom === false ||\n      (this._state !== this.STATE.NONE && this._state !== this.STATE.ROTATE)\n    )\n      return;\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.handleMouseWheel(event);\n  }\n\n  /**\n   * Total handling of keyboard down events.\n   */\n  onKeyDown(event: KeyboardEvent) {\n    if (this.enabled === false || this.enableKeys === false || this.enablePan === false) return;\n\n    this.handleKeyDown(event);\n  }\n\n  /**\n   * Total handling of touch start events.\n   */\n  onTouchStart(event: TouchEvent) {\n    if (this.enabled === false) return;\n\n    this._isMouseUp = false;\n\n    switch (event.touches.length) {\n      case this.touchFingers.ORBIT:\n        if (this.enableRotate === false) return;\n\n        this.handleTouchStartRotate(event);\n        this._state = this.STATE.TOUCH_ROTATE;\n\n        break;\n\n      case this.touchFingers.ZOOM:\n        if (this.enableZoom === false) return;\n\n        this.handleTouchStartZoom(event);\n        this._state = this.STATE.TOUCH_ZOOM;\n\n        break;\n\n      case this.touchFingers.PAN:\n        if (this.enablePan === false) return;\n\n        this.handleTouchStartPan(event);\n        this._state = this.STATE.TOUCH_PAN;\n\n        break;\n\n      default:\n        this._state = this.STATE.NONE;\n    }\n  }\n\n  /**\n   * Total handling of touch movement events.\n   */\n  onTouchMove(event: TouchEvent) {\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    switch (event.touches.length) {\n      case this.touchFingers.ORBIT:\n        if (this.enableRotate === false) return;\n        if (this._state !== this.STATE.TOUCH_ROTATE) return;\n        this.handleTouchMoveRotate(event);\n\n        break;\n\n      case this.touchFingers.ZOOM:\n        if (this.enableZoom === false) return;\n        if (this._state !== this.STATE.TOUCH_ZOOM) return;\n        this.handleTouchMoveZoom(event);\n\n        break;\n\n      case this.touchFingers.PAN:\n        if (this.enablePan === false) return;\n        if (this._state !== this.STATE.TOUCH_PAN) return;\n        this.handleTouchMovePan(event);\n\n        break;\n\n      default:\n        this._state = this.STATE.NONE;\n    }\n  }\n\n  /**\n   * Total handling of touch end events.\n   */\n  onTouchEnd() {\n    if (this.enabled === false) return;\n\n    this._isMouseUp = true;\n    this._state = this.STATE.NONE;\n  }\n\n  /**\n   * Context event hiding.\n   */\n  onContextMenu(event) {\n    if (this.enabled === false) return;\n    event.preventDefault();\n  }\n}\n"],"names":["ESP","MathUtil","zeroTolerance","includes","array","filterArray","some","e","indexOf","FreeControl","entity","_forward","Vector3","_right","camera","mainElement","domElement","movementSpeed","rotateSpeed","floorMock","floorY","press","keysForward","keysBackward","keysLeft","keysRight","_theta","_phi","_moveForward","_moveBackward","_moveLeft","_moveRight","_v3Cache","_spherical","_rotateOri","_events","scene","engine","canvas","_webCanvas","document","Spherical","type","listener","onMouseMove","bind","onMouseDown","onMouseUp","onKeyDown","element","window","onKeyUp","onContextMenu","initEvents","updateSpherical","event","preventDefault","code","key","keyCode","stopPropagation","changedTouches","focus","clientX","clientY","enabled","movementX","movementY","factorX","width","factorY","height","actualX","actualY","rotate","alpha","beta","degreeToRadian","clamp","Math","PI","theta","phi","setToVec3","add","transform","position","lookAt","onUpdate","delta","actualMoveSpeed","getWorldForward","getWorldRight","translate","scale","y","setPosition","x","z","forEach","ele","addEventListener","onDestroy","removeEventListener","setValue","transformByQuat","rotation","setFromVec3","Script","OrbitControl","fov","target","up","minDistance","maxDistance","minZoom","maxZoom","enableDamping","zoomFactor","enableRotate","keyPanSpeed","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableZoom","dampingFactor","zoomSpeed","enablePan","autoRotate","autoRotateSpeed","enableKeys","keys","mouseButtons","touchFingers","STATE","mouseUpEvents","constEvents","_position","_offset","_sphericalDelta","_sphericalDump","_zoomFrag","_scale","_panOffset","_isMouseUp","_vPan","_state","_rotateStart","_rotateEnd","_rotateDelta","_panStart","_panEnd","_panDelta","_zoomStart","_zoomEnd","_zoomDelta","_oriTarget","Infinity","LEFT","UP","RIGHT","BOTTOM","ORBIT","ZOOM","PAN","Vector2","NONE","ROTATE","TOUCH_ROTATE","TOUCH_ZOOM","TOUCH_PAN","onMouseWheel","onTouchStart","onTouchMove","onTouchEnd","onDisable","body","dtime","cloneTo","subtract","rotateLeft","getAutoRotationAngle","max","min","makeSafe","radius","equals","set","getZoomScale","pow","radian","rotateUp","panLeft","distance","worldMatrix","elements","panUp","pan","deltaX","deltaY","targetDistance","length","clientHeight","zoomIn","zoomScale","zoomOut","handleMouseDownRotate","handleMouseDownZoom","handleMouseDownPan","handleMouseMoveRotate","clientWidth","handleMouseMoveZoom","handleMouseMovePan","handleMouseWheel","handleKeyDown","handleTouchStartRotate","touches","pageX","pageY","handleTouchStartZoom","dx","dy","sqrt","handleTouchStartPan","handleTouchMoveRotate","handleTouchMoveZoom","handleTouchMovePan","button"],"mappings":";;;;;;;;;;;;;;;;AAGA,IAAMA,GAAG,GAAGC,QAAQ,CAACC,aAArB;;AAEA,SAASC,QAAT,CAAkBC,KAAlB,EAAyC;AAAA,oCAAbC,WAAa;AAAbA,IAAAA,WAAa;AAAA;;AACvC,SAAOA,WAAW,CAACC,IAAZ,CAAiB,UAACC,CAAD;AAAA,WAAOH,KAAK,CAACI,OAAN,CAAcD,CAAd,MAAqB,CAAC,CAA7B;AAAA,GAAjB,CAAP;AACD;AAED;AACA;AACA;;;IACaE,WAAb;AAAA;;AAOE;AACF;AACA;;AAGE;AACF;AACA;;AAGE;AACF;AACA;;AAGE;AACF;AACA;;AAGE;AACF;AACA;;AAOE;AACF;AACA;;AAGE;AACF;AACA;AAaE,uBAAYC,MAAZ,EAA4B;AAAA;;AAC1B,+BAAMA,MAAN;AAD0B,UAvD5BC,QAuD4B,GAvDjB,IAAIC,OAAJ,EAuDiB;AAAA,UAtD5BC,MAsD4B,GAtDnB,IAAID,OAAJ,EAsDmB;AAAA,UArD5BE,MAqD4B;AAAA,UApD5BC,WAoD4B;AAAA,UAnD5BC,UAmD4B;AAAA,UA9C5BC,aA8C4B;AAAA,UAzC5BC,WAyC4B;AAAA,UApC5BC,SAoC4B;AAAA,UA/B5BC,MA+B4B;AAAA,UA1B5BC,KA0B4B;AAAA,UAzB5BC,WAyB4B;AAAA,UAxB5BC,YAwB4B;AAAA,UAvB5BC,QAuB4B;AAAA,UAtB5BC,SAsB4B;AAAA,UAjBpBC,MAiBoB;AAAA,UAZpBC,IAYoB;AAAA,UAVpBC,YAUoB;AAAA,UATpBC,aASoB;AAAA,UARpBC,SAQoB;AAAA,UAPpBC,UAOoB;AAAA,UALpBC,QAKoB;AAAA,UAJpBC,UAIoB;AAAA,UAHpBC,UAGoB;AAAA,UAFpBC,OAEoB;AAE1B,UAAKrB,MAAL,GAAcJ,MAAd,CAF0B;AAI1B;;AACA,UAAKK,WAAL,GAAmB,MAAKqB,KAAL,CAAWC,MAAX,CAAkBC,MAAlB,CAAyBC,UAA5C;AACA,UAAKvB,UAAL,GAAkBwB,QAAlB;AAEA,UAAKvB,aAAL,GAAqB,GAArB;AACA,UAAKC,WAAL,GAAmB,GAAnB;AAEA,UAAKC,SAAL,GAAiB,IAAjB;AACA,UAAKC,MAAL,GAAc,CAAd;AAEA,UAAKC,KAAL,GAAa,KAAb;AAEA,UAAKC,WAAL,GAAmB,CAAC,MAAD,EAAS,SAAT,CAAnB;AACA,UAAKC,YAAL,GAAoB,CAAC,MAAD,EAAS,WAAT,CAApB;AACA,UAAKC,QAAL,GAAgB,CAAC,MAAD,EAAS,WAAT,CAAhB;AACA,UAAKC,SAAL,GAAiB,CAAC,MAAD,EAAS,YAAT,CAAjB;AAEA,UAAKC,MAAL,GAAc,CAAd;AACA,UAAKC,IAAL,GAAY,CAAZ,CAtB0B;;AAyB1B,UAAKC,YAAL,GAAoB,KAApB;AACA,UAAKC,aAAL,GAAqB,KAArB;AACA,UAAKC,SAAL,GAAiB,KAAjB;AACA,UAAKC,UAAL,GAAkB,KAAlB;AAEA,UAAKC,QAAL,GAAgB,IAAIpB,OAAJ,EAAhB;AACA,UAAKqB,UAAL,GAAkB,IAAIQ,SAAJ,EAAlB;AACA,UAAKP,UAAL,GAAkB,CAAC,CAAD,EAAI,CAAJ,CAAlB;AAEA,UAAKC,OAAL,GAAe,CACb;AAAEO,MAAAA,IAAI,EAAE,WAAR;AAAqBC,MAAAA,QAAQ,EAAE,MAAKC,WAAL,CAAiBC,IAAjB;AAA/B,KADa,EAEb;AAAEH,MAAAA,IAAI,EAAE,WAAR;AAAqBC,MAAAA,QAAQ,EAAE,MAAKC,WAAL,CAAiBC,IAAjB;AAA/B,KAFa,EAGb;AAAEH,MAAAA,IAAI,EAAE,WAAR;AAAqBC,MAAAA,QAAQ,EAAE,MAAKG,WAAL,CAAiBD,IAAjB;AAA/B,KAHa,EAIb;AAAEH,MAAAA,IAAI,EAAE,YAAR;AAAsBC,MAAAA,QAAQ,EAAE,MAAKG,WAAL,CAAiBD,IAAjB;AAAhC,KAJa,EAKb;AAAEH,MAAAA,IAAI,EAAE,SAAR;AAAmBC,MAAAA,QAAQ,EAAE,MAAKI,SAAL,CAAeF,IAAf;AAA7B,KALa,EAMb;AAAEH,MAAAA,IAAI,EAAE,UAAR;AAAoBC,MAAAA,QAAQ,EAAE,MAAKI,SAAL,CAAeF,IAAf;AAA9B,KANa,EAOb;AAAEH,MAAAA,IAAI,EAAE,SAAR;AAAmBC,MAAAA,QAAQ,EAAE,MAAKK,SAAL,CAAeH,IAAf,+BAA7B;AAAwDI,MAAAA,OAAO,EAAEC;AAAjE,KAPa,EAQb;AAAER,MAAAA,IAAI,EAAE,OAAR;AAAiBC,MAAAA,QAAQ,EAAE,MAAKQ,OAAL,CAAaN,IAAb,+BAA3B;AAAoDI,MAAAA,OAAO,EAAEC;AAA7D,KARa,EASb;AAAER,MAAAA,IAAI,EAAE,aAAR;AAAuBC,MAAAA,QAAQ,EAAE,MAAKS,aAAL,CAAmBP,IAAnB;AAAjC,KATa,CAAf;;AAYA,UAAKQ,UAAL,GA9C0B;;;AAiD1B,UAAKC,eAAL;;AAjD0B;AAkD3B;AAED;AACF;AACA;;;AA9GA;;AAAA,SA+GEF,aA/GF,GA+GE,uBAAcG,KAAd,EAA2B;AACzBA,IAAAA,KAAK,CAACC,cAAN;AACD;AAED;AACF;AACA;AArHA;;AAAA,SAsHER,SAtHF,GAsHE,mBAAUO,KAAV,EAAuB;AAAA,QACbE,IADa,GACUF,KADV,CACbE,IADa;AAAA,QACPC,GADO,GACUH,KADV,CACPG,GADO;AAAA,QACFC,OADE,GACUJ,KADV,CACFI,OADE;;AAErB,QAAIxD,QAAQ,CAAC,KAAKmB,WAAN,EAAmBmC,IAAnB,EAAyBC,GAAzB,EAA8BC,OAA9B,CAAZ,EAAoD;AAClD,WAAK/B,YAAL,GAAoB,IAApB;AACD,KAFD,MAEO,IAAIzB,QAAQ,CAAC,KAAKoB,YAAN,EAAoBkC,IAApB,EAA0BC,GAA1B,EAA+BC,OAA/B,CAAZ,EAAqD;AAC1D,WAAK9B,aAAL,GAAqB,IAArB;AACD,KAFM,MAEA,IAAI1B,QAAQ,CAAC,KAAKqB,QAAN,EAAgBiC,IAAhB,EAAsBC,GAAtB,EAA2BC,OAA3B,CAAZ,EAAiD;AACtD,WAAK7B,SAAL,GAAiB,IAAjB;AACD,KAFM,MAEA,IAAI3B,QAAQ,CAAC,KAAKsB,SAAN,EAAiBgC,IAAjB,EAAuBC,GAAvB,EAA4BC,OAA5B,CAAZ,EAAkD;AACvD,WAAK5B,UAAL,GAAkB,IAAlB;AACD;AACF;AAED;AACF;AACA;AArIA;;AAAA,SAsIEoB,OAtIF,GAsIE,iBAAQI,KAAR,EAAqB;AAAA,QACXE,IADW,GACYF,KADZ,CACXE,IADW;AAAA,QACLC,GADK,GACYH,KADZ,CACLG,GADK;AAAA,QACAC,OADA,GACYJ,KADZ,CACAI,OADA;;AAEnB,QAAIxD,QAAQ,CAAC,KAAKmB,WAAN,EAAmBmC,IAAnB,EAAyBC,GAAzB,EAA8BC,OAA9B,CAAZ,EAAoD;AAClD,WAAK/B,YAAL,GAAoB,KAApB;AACD,KAFD,MAEO,IAAIzB,QAAQ,CAAC,KAAKoB,YAAN,EAAoBkC,IAApB,EAA0BC,GAA1B,EAA+BC,OAA/B,CAAZ,EAAqD;AAC1D,WAAK9B,aAAL,GAAqB,KAArB;AACD,KAFM,MAEA,IAAI1B,QAAQ,CAAC,KAAKqB,QAAN,EAAgBiC,IAAhB,EAAsBC,GAAtB,EAA2BC,OAA3B,CAAZ,EAAiD;AACtD,WAAK7B,SAAL,GAAiB,KAAjB;AACD,KAFM,MAEA,IAAI3B,QAAQ,CAAC,KAAKsB,SAAN,EAAiBgC,IAAjB,EAAuBC,GAAvB,EAA4BC,OAA5B,CAAZ,EAAkD;AACvD,WAAK5B,UAAL,GAAkB,KAAlB;AACD;AACF;AAED;AACF;AACA;AArJA;;AAAA,SAsJEe,WAtJF,GAsJE,qBAAYS,KAAZ,EAAyB;AACvBA,IAAAA,KAAK,CAACK,eAAN;AACAL,IAAAA,KAAK,GAAIA,KAAK,CAACM,cAAN,IAAwBN,KAAK,CAACM,cAAN,CAAqB,CAArB,CAAzB,IAAqDN,KAA7D;;AAEA,QAAI,KAAKvC,UAAL,KAAoBwB,QAAxB,EAAkC;AAChC,WAAKxB,UAAL,CAAgB8C,KAAhB;AACD;;AAED,SAAKzC,KAAL,GAAa,IAAb;AACA,SAAKa,UAAL,GAAkB,CAACqB,KAAK,CAACQ,OAAP,EAAgBR,KAAK,CAACS,OAAtB,CAAlB;AACD;AAED;AACF;AACA;AApKA;;AAAA,SAqKEjB,SArKF,GAqKE,mBAAUQ,KAAV,EAAuB;AACrBA,IAAAA,KAAK,CAACC,cAAN;AACAD,IAAAA,KAAK,CAACK,eAAN;AAEA,SAAKvC,KAAL,GAAa,KAAb;AACD;AAED;AACF;AACA;AA9KA;;AAAA,SA+KEuB,WA/KF,GA+KE,qBAAYW,KAAZ,EAAyB;AACvB,QAAI,KAAKlC,KAAL,KAAe,KAAnB,EAA0B;AAC1B,QAAI,KAAK4C,OAAL,KAAiB,KAArB,EAA4B;AAE5BV,IAAAA,KAAK,CAACC,cAAN;AACAD,IAAAA,KAAK,CAACK,eAAN;AACAL,IAAAA,KAAK,GAAIA,KAAK,CAACM,cAAN,IAAwBN,KAAK,CAACM,cAAN,CAAqB,CAArB,CAAzB,IAAqDN,KAA7D;AAEA,QAAMW,SAAS,GAAGX,KAAK,CAACQ,OAAN,GAAgB,KAAK7B,UAAL,CAAgB,CAAhB,CAAlC;AACA,QAAMiC,SAAS,GAAGZ,KAAK,CAACS,OAAN,GAAgB,KAAK9B,UAAL,CAAgB,CAAhB,CAAlC;AACA,SAAKA,UAAL,CAAgB,CAAhB,IAAqBqB,KAAK,CAACQ,OAA3B;AACA,SAAK7B,UAAL,CAAgB,CAAhB,IAAqBqB,KAAK,CAACS,OAA3B;AACA,QAAMI,OAAO,GAAG,MAAM,KAAKrD,WAAL,CAAiBsD,KAAvC;AACA,QAAMC,OAAO,GAAG,MAAM,KAAKvD,WAAL,CAAiBwD,MAAvC;AACA,QAAMC,OAAO,GAAGN,SAAS,GAAGE,OAA5B;AACA,QAAMK,OAAO,GAAGN,SAAS,GAAGG,OAA5B;AAEA,SAAKI,MAAL,CAAY,CAACF,OAAb,EAAsBC,OAAtB;AACD;AAED;AACF;AACA;AACA;AACA;AAvMA;;AAAA,SAwMEC,MAxMF,GAwME,gBAAOC,KAAP,EAA0BC,IAA1B,EAAkD;AAAA,QAA3CD,KAA2C;AAA3CA,MAAAA,KAA2C,GAA3B,CAA2B;AAAA;;AAAA,QAAxBC,IAAwB;AAAxBA,MAAAA,IAAwB,GAAT,CAAS;AAAA;;AAChD,SAAKlD,MAAL,IAAezB,QAAQ,CAAC4E,cAAT,CAAwBF,KAAxB,CAAf;AACA,SAAKhD,IAAL,IAAa1B,QAAQ,CAAC4E,cAAT,CAAwBD,IAAxB,CAAb;AACA,SAAKjD,IAAL,GAAY1B,QAAQ,CAAC6E,KAAT,CAAe,KAAKnD,IAApB,EAA0B3B,GAA1B,EAA+B+E,IAAI,CAACC,EAAL,GAAUhF,GAAzC,CAAZ;AACA,SAAKiC,UAAL,CAAgBgD,KAAhB,GAAwB,KAAKvD,MAA7B;AACA,SAAKO,UAAL,CAAgBiD,GAAhB,GAAsB,KAAKvD,IAA3B;;AACA,SAAKM,UAAL,CAAgBkD,SAAhB,CAA0B,KAAKnD,QAA/B;;AACApB,IAAAA,OAAO,CAACwE,GAAR,CAAY,KAAKtE,MAAL,CAAYuE,SAAZ,CAAsBC,QAAlC,EAA4C,KAAKtD,QAAjD,EAA2D,KAAKA,QAAhE;AACA,SAAKlB,MAAL,CAAYuE,SAAZ,CAAsBE,MAAtB,CAA6B,KAAKvD,QAAlC,EAA4C,IAAIpB,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA5C;AACD,GAjNH;;AAAA,SAmNE4E,QAnNF,GAmNE,kBAASC,KAAT,EAA8B;AAC5B,QAAI,KAAKxB,OAAL,KAAiB,KAArB,EAA4B;AAE5B,QAAMyB,eAAe,GAAID,KAAK,GAAG,IAAT,GAAiB,KAAKxE,aAA9C;AACA,SAAKH,MAAL,CAAYuE,SAAZ,CAAsBM,eAAtB,CAAsC,KAAKhF,QAA3C;AACA,SAAKG,MAAL,CAAYuE,SAAZ,CAAsBO,aAAtB,CAAoC,KAAK/E,MAAzC;;AACA,QAAI,KAAKe,YAAT,EAAuB;AACrB,WAAKd,MAAL,CAAYuE,SAAZ,CAAsBQ,SAAtB,CAAgC,KAAKlF,QAAL,CAAcmF,KAAd,CAAoBJ,eAApB,CAAhC;AACD;;AACD,QAAI,KAAK7D,aAAT,EAAwB;AACtB,WAAKf,MAAL,CAAYuE,SAAZ,CAAsBQ,SAAtB,CAAgC,KAAKlF,QAAL,CAAcmF,KAAd,CAAoB,CAACJ,eAArB,CAAhC;AACD;;AACD,QAAI,KAAK5D,SAAT,EAAoB;AAClB,WAAKhB,MAAL,CAAYuE,SAAZ,CAAsBQ,SAAtB,CAAgC,KAAKhF,MAAL,CAAYiF,KAAZ,CAAkB,CAACJ,eAAnB,CAAhC;AACD;;AACD,QAAI,KAAK3D,UAAT,EAAqB;AACnB,WAAKjB,MAAL,CAAYuE,SAAZ,CAAsBQ,SAAtB,CAAgC,KAAKhF,MAAL,CAAYiF,KAAZ,CAAkBJ,eAAlB,CAAhC;AACD;;AAED,QAAI,KAAKvE,SAAT,EAAoB;AAClB,UAAMmE,QAAQ,GAAG,KAAKxE,MAAL,CAAYuE,SAAZ,CAAsBC,QAAvC;;AACA,UAAIA,QAAQ,CAACS,CAAT,KAAe,KAAK3E,MAAxB,EAAgC;AAC9B,aAAKN,MAAL,CAAYuE,SAAZ,CAAsBW,WAAtB,CAAkCV,QAAQ,CAACW,CAA3C,EAA8C,KAAK7E,MAAnD,EAA2DkE,QAAQ,CAACY,CAApE;AACD;AACF;AACF;AAED;AACF;AACA;AAhPA;;AAAA,SAiPE7C,UAjPF,GAiPE,sBAAmB;AAAA;;AACjB,SAAKlB,OAAL,CAAagE,OAAb,CAAqB,UAACC,GAAD,EAAS;AAC5B,UAAIA,GAAG,CAACnD,OAAR,EAAiB;AACfmD,QAAAA,GAAG,CAACnD,OAAJ,CAAYoD,gBAAZ,CAA6BD,GAAG,CAAC1D,IAAjC,EAAuC0D,GAAG,CAACzD,QAA3C,EAAqD,KAArD;AACD,OAFD,MAEO;AACL,QAAA,MAAI,CAAC5B,WAAL,CAAiBsF,gBAAjB,CAAkCD,GAAG,CAAC1D,IAAtC,EAA4C0D,GAAG,CAACzD,QAAhD,EAA0D,KAA1D;AACD;AACF,KAND;AAOD,GAzPH;;AAAA,SA2PE2D,SA3PF,GA2PE,qBAAkB;AAAA;;AAChB,SAAKnE,OAAL,CAAagE,OAAb,CAAqB,UAACC,GAAD,EAAS;AAC5B,UAAIA,GAAG,CAACnD,OAAR,EAAiB;AACfmD,QAAAA,GAAG,CAACnD,OAAJ,CAAYsD,mBAAZ,CAAgCH,GAAG,CAAC1D,IAApC,EAA0C0D,GAAG,CAACzD,QAA9C,EAAwD,KAAxD;AACD,OAFD,MAEO;AACL,QAAA,MAAI,CAAC5B,WAAL,CAAiBwF,mBAAjB,CAAqCH,GAAG,CAAC1D,IAAzC,EAA+C0D,GAAG,CAACzD,QAAnD,EAA6D,KAA7D;AACD;AACF,KAND;AAOD;AAED;AACF;AACA;AACA;AACA;AACA;AA1QA;;AAAA,SA2QEW,eA3QF,GA2QE,2BAAwB;AACtB,SAAKtB,QAAL,CAAcwE,QAAd,CAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAAC,CAA9B;;AACA5F,IAAAA,OAAO,CAAC6F,eAAR,CAAwB,KAAKzE,QAA7B,EAAuC,KAAKlB,MAAL,CAAY4F,QAAnD,EAA6D,KAAK1E,QAAlE;;AACA,SAAKC,UAAL,CAAgB0E,WAAhB,CAA4B,KAAK3E,QAAjC;;AACA,SAAKN,MAAL,GAAc,KAAKO,UAAL,CAAgBgD,KAA9B;AACA,SAAKtD,IAAL,GAAY,KAAKM,UAAL,CAAgBiD,GAA5B;AACD,GAjRH;;AAAA;AAAA,EAAiC0B,MAAjC;;ACTA;AACA;AACA;;IACaC,YAAb;AAAA;;AAgEE,wBAAYnG,MAAZ,EAA4B;AAAA;;AAC1B,+BAAMA,MAAN;AAD0B,UA/D5BI,MA+D4B;AAAA,UA9D5BE,UA8D4B;AAAA,UA7D5BD,WA6D4B;AAAA,UA5D5B+F,GA4D4B;AAAA,UA3D5BC,MA2D4B;AAAA,UA1D5BC,EA0D4B;AAAA,UAzD5BC,WAyD4B;AAAA,UAxD5BC,WAwD4B;AAAA,UAvD5BC,OAuD4B;AAAA,UAtD5BC,OAsD4B;AAAA,UArD5BC,aAqD4B;AAAA,UApD5BC,UAoD4B;AAAA,UAnD5BC,YAmD4B;AAAA,UAlD5BC,WAkD4B;AAAA,UAjD5BC,aAiD4B;AAAA,UAhD5BC,aAgD4B;AAAA,UA/C5BC,eA+C4B;AAAA,UA9C5BC,eA8C4B;AAAA,UA7C5BC,UA6C4B;AAAA,UA5C5BC,aA4C4B;AAAA,UA3C5BC,SA2C4B;AAAA,UA1C5BC,SA0C4B;AAAA,UAzC5BC,UAyC4B;AAAA,UAxC5BC,eAwC4B;AAAA,UAvC5BhH,WAuC4B;AAAA,UAtC5BiH,UAsC4B;AAAA,UArC5BC,IAqC4B;AAAA,UApC5BC,YAoC4B;AAAA,UAnC5BC,YAmC4B;AAAA,UAlC5BC,KAkC4B;AAAA,UAzB5BC,aAyB4B;AAAA,UAxB5BC,WAwB4B;AAAA,UAtBpBC,SAsBoB;AAAA,UArBpBC,OAqBoB;AAAA,UApBpB1G,UAoBoB;AAAA,UAnBpB2G,eAmBoB;AAAA,UAlBpBC,cAkBoB;AAAA,UAjBpBC,SAiBoB;AAAA,UAhBpBC,MAgBoB;AAAA,UAfpBC,UAeoB;AAAA,UAdpBC,UAcoB;AAAA,UAbpBC,KAaoB;AAAA,UAZpBC,MAYoB;AAAA,UAXpBC,YAWoB;AAAA,UAVpBC,UAUoB;AAAA,UATpBC,YASoB;AAAA,UARpBC,SAQoB;AAAA,UAPpBC,OAOoB;AAAA,UANpBC,SAMoB;AAAA,UALpBC,UAKoB;AAAA,UAJpBC,QAIoB;AAAA,UAHpBC,UAGoB;AAAA,UAFpBC,UAEoB,GAFP,IAAIjJ,OAAJ,CAAYkJ,QAAZ,EAAsBA,QAAtB,EAAgCA,QAAhC,CAEO;AAG1B,UAAKhJ,MAAL,GAAcJ,MAAd,CAH0B;AAK1B;;AACA,UAAKK,WAAL,GAAmB,MAAKsB,MAAL,CAAYC,MAAZ,CAAmBC,UAAtC;AACA,UAAKvB,UAAL,GAAkBwB,QAAlB;AACA,UAAKsE,GAAL,GAAW,EAAX,CAR0B;;AAW1B,UAAKC,MAAL,GAAc,IAAInG,OAAJ,EAAd,CAX0B;;AAc1B,UAAKoG,EAAL,GAAU,IAAIpG,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAV;AAEA;AACJ;AACA;;AACI,UAAKqG,WAAL,GAAmB,GAAnB;AACA;AACJ;AACA;;AACI,UAAKC,WAAL,GAAmB4C,QAAnB;AAEA;AACJ;AACA;AACA;;AACI,UAAK3C,OAAL,GAAe,GAAf;AAEA;AACJ;AACA;;AACI,UAAKC,OAAL,GAAe0C,QAAf;AAEA;AACJ;AACA;;AACI,UAAKrC,aAAL,GAAqB,CAArB;AAEA;AACJ;AACA;;AACI,UAAKC,aAAL,GAAqB3C,IAAI,CAACC,EAA1B;AAEA;AACJ;AACA;;AACI,UAAK2C,eAAL,GAAuB,CAACmC,QAAxB;AAEA;AACJ;AACA;;AACI,UAAKlC,eAAL,GAAuBkC,QAAvB;AAEA;AACJ;AACA;;AACI,UAAKzC,aAAL,GAAqB,IAArB;AAEA;AACJ;AACA;;AACI,UAAKS,aAAL,GAAqB,GAArB;AAEA;AACJ;AACA;;AACI,UAAKR,UAAL,GAAkB,GAAlB;AAEA;AACJ;AACA;;AACI,UAAKO,UAAL,GAAkB,IAAlB;AAEA;AACJ;AACA;;AACI,UAAKE,SAAL,GAAiB,GAAjB;AAEA;AACJ;AACA;;AACI,UAAKR,YAAL,GAAoB,IAApB;AAEA;AACJ;AACA;;AACI,UAAKrG,WAAL,GAAmB,GAAnB;AAEA;AACJ;AACA;;AACI,UAAK8G,SAAL,GAAiB,IAAjB;AAEA;AACJ;AACA;;AACI,UAAKR,WAAL,GAAmB,GAAnB;AAEA;AACJ;AACA;;AACI,UAAKS,UAAL,GAAkB,KAAlB;AAEA;AACJ;AACA;;AACI,UAAKC,eAAL,GAAuB,GAAvB;AAEA;AACJ;AACA;;AACI,UAAKC,UAAL,GAAkB,KAAlB;AACA,UAAKC,IAAL,GAAY;AACV2B,MAAAA,IAAI,EAAE,EADI;AAEVC,MAAAA,EAAE,EAAE,EAFM;AAGVC,MAAAA,KAAK,EAAE,EAHG;AAIVC,MAAAA,MAAM,EAAE;AAJE,KAAZ,CAnH0B;;AA2H1B,UAAK7B,YAAL,GAAoB;AAClB8B,MAAAA,KAAK,EAAE,CADW;AAElBC,MAAAA,IAAI,EAAE,CAFY;AAGlBC,MAAAA,GAAG,EAAE;AAHa,KAApB;AAMA,UAAK/B,YAAL,GAAoB;AAClB6B,MAAAA,KAAK,EAAE,CADW;AAElBC,MAAAA,IAAI,EAAE,CAFY;AAGlBC,MAAAA,GAAG,EAAE;AAHa,KAApB,CAjI0B;AAwI1B;;AACA,UAAK3B,SAAL,GAAiB,IAAI9H,OAAJ,EAAjB;AACA,UAAK+H,OAAL,GAAe,IAAI/H,OAAJ,EAAf;AACA,UAAKqB,UAAL,GAAkB,IAAIQ,SAAJ,EAAlB;AACA,UAAKmG,eAAL,GAAuB,IAAInG,SAAJ,EAAvB;AACA,UAAKoG,cAAL,GAAsB,IAAIpG,SAAJ,EAAtB;AACA,UAAKqG,SAAL,GAAiB,CAAjB;AACA,UAAKC,MAAL,GAAc,CAAd;AACA,UAAKC,UAAL,GAAkB,IAAIpI,OAAJ,EAAlB;AACA,UAAKqI,UAAL,GAAkB,IAAlB,CAjJ0B;;AAoJ1B,UAAKC,KAAL,GAAa,IAAItI,OAAJ,EAAb,CApJ0B;;AAuJ1B,UAAKwI,YAAL,GAAoB,IAAIkB,OAAJ,EAApB;AACA,UAAKjB,UAAL,GAAkB,IAAIiB,OAAJ,EAAlB;AACA,UAAKhB,YAAL,GAAoB,IAAIgB,OAAJ,EAApB;AAEA,UAAKf,SAAL,GAAiB,IAAIe,OAAJ,EAAjB;AACA,UAAKd,OAAL,GAAe,IAAIc,OAAJ,EAAf;AACA,UAAKb,SAAL,GAAiB,IAAIa,OAAJ,EAAjB;AAEA,UAAKZ,UAAL,GAAkB,IAAIY,OAAJ,EAAlB;AACA,UAAKX,QAAL,GAAgB,IAAIW,OAAJ,EAAhB;AACA,UAAKV,UAAL,GAAkB,IAAIU,OAAJ,EAAlB;AAEA,UAAK/B,KAAL,GAAa;AACXgC,MAAAA,IAAI,EAAE,CAAC,CADI;AAEXC,MAAAA,MAAM,EAAE,CAFG;AAGXJ,MAAAA,IAAI,EAAE,CAHK;AAIXC,MAAAA,GAAG,EAAE,CAJM;AAKXI,MAAAA,YAAY,EAAE,CALH;AAMXC,MAAAA,UAAU,EAAE,CAND;AAOXC,MAAAA,SAAS,EAAE;AAPA,KAAb;AASA,UAAKxB,MAAL,GAAc,MAAKZ,KAAL,CAAWgC,IAAzB;AAEA,UAAK9B,WAAL,GAAmB,CACjB;AAAE/F,MAAAA,IAAI,EAAE,WAAR;AAAqBC,MAAAA,QAAQ,EAAE,MAAKG,WAAL,CAAiBD,IAAjB;AAA/B,KADiB,EAEjB;AAAEH,MAAAA,IAAI,EAAE,OAAR;AAAiBC,MAAAA,QAAQ,EAAE,MAAKiI,YAAL,CAAkB/H,IAAlB;AAA3B,KAFiB,EAGjB;AAAEH,MAAAA,IAAI,EAAE,SAAR;AAAmBC,MAAAA,QAAQ,EAAE,MAAKK,SAAL,CAAeH,IAAf,+BAA7B;AAAwDI,MAAAA,OAAO,EAAEC;AAAjE,KAHiB,EAIjB;AAAER,MAAAA,IAAI,EAAE,YAAR;AAAsBC,MAAAA,QAAQ,EAAE,MAAKkI,YAAL,CAAkBhI,IAAlB;AAAhC,KAJiB,EAKjB;AAAEH,MAAAA,IAAI,EAAE,WAAR;AAAqBC,MAAAA,QAAQ,EAAE,MAAKmI,WAAL,CAAiBjI,IAAjB;AAA/B,KALiB,EAMjB;AAAEH,MAAAA,IAAI,EAAE,UAAR;AAAoBC,MAAAA,QAAQ,EAAE,MAAKoI,UAAL,CAAgBlI,IAAhB;AAA9B,KANiB,EAOjB;AAAEH,MAAAA,IAAI,EAAE,aAAR;AAAuBC,MAAAA,QAAQ,EAAE,MAAKS,aAAL,CAAmBP,IAAnB;AAAjC,KAPiB,CAAnB;AAUA,UAAK2F,aAAL,GAAqB,CACnB;AAAE9F,MAAAA,IAAI,EAAE,WAAR;AAAqBC,MAAAA,QAAQ,EAAE,MAAKC,WAAL,CAAiBC,IAAjB;AAA/B,KADmB,EAEnB;AAAEH,MAAAA,IAAI,EAAE,SAAR;AAAmBC,MAAAA,QAAQ,EAAE,MAAKI,SAAL,CAAeF,IAAf;AAA7B,KAFmB,CAArB;;AAKA,UAAK4F,WAAL,CAAiBtC,OAAjB,CAAyB,UAACC,GAAD,EAAS;AAChC,UAAIA,GAAG,CAACnD,OAAR,EAAiB;AACfmD,QAAAA,GAAG,CAACnD,OAAJ,CAAYoD,gBAAZ,CAA6BD,GAAG,CAAC1D,IAAjC,EAAuC0D,GAAG,CAACzD,QAA3C,EAAqD,KAArD;AACD,OAFD,MAEO;AACL,cAAK5B,WAAL,CAAiBsF,gBAAjB,CAAkCD,GAAG,CAAC1D,IAAtC,EAA4C0D,GAAG,CAACzD,QAAhD,EAA0D,KAA1D;AACD;AACF,KAND;;AA7L0B;AAoM3B;;AApQH;;AAAA,SAsQEqI,SAtQF,GAsQE,qBAAkB;AAChB,QAAM/H,OAAO,GAAG,KAAKjC,UAAL,KAAoBwB,QAApB,GAA+B,KAAKxB,UAAL,CAAgBiK,IAA/C,GAAsD,KAAKjK,UAA3E;AACA,SAAKD,WAAL,CAAiBwF,mBAAjB,CAAqC,KAAKiC,aAAL,CAAmB,CAAnB,EAAsB9F,IAA3D,EAAiE,KAAK8F,aAAL,CAAmB,CAAnB,EAAsB7F,QAAvF,EAAiG,KAAjG;AACAM,IAAAA,OAAO,CAACsD,mBAAR,CAA4B,KAAKiC,aAAL,CAAmB,CAAnB,EAAsB9F,IAAlD,EAAwD,KAAK8F,aAAL,CAAmB,CAAnB,EAAsB7F,QAA9E,EAAwF,KAAxF;AACD,GA1QH;;AAAA,SA4QE2D,SA5QF,GA4QE,qBAAY;AAAA;;AACV,SAAKmC,WAAL,CAAiBtC,OAAjB,CAAyB,UAACC,GAAD,EAAS;AAChC,UAAIA,GAAG,CAACnD,OAAR,EAAiB;AACfmD,QAAAA,GAAG,CAACnD,OAAJ,CAAYsD,mBAAZ,CAAgCH,GAAG,CAAC1D,IAApC,EAA0C0D,GAAG,CAACzD,QAA9C,EAAwD,KAAxD;AACD,OAFD,MAEO;AACL,QAAA,MAAI,CAAC5B,WAAL,CAAiBwF,mBAAjB,CAAqCH,GAAG,CAAC1D,IAAzC,EAA+C0D,GAAG,CAACzD,QAAnD,EAA6D,KAA7D;AACD;AACF,KAND;AAOA,QAAMM,OAAO,GAAG,KAAKjC,UAAL,KAAoBwB,QAApB,GAA+B,KAAKxB,UAAL,CAAgBiK,IAA/C,GAAsD,KAAKjK,UAA3E;AACA,SAAKD,WAAL,CAAiBwF,mBAAjB,CAAqC,KAAKiC,aAAL,CAAmB,CAAnB,EAAsB9F,IAA3D,EAAiE,KAAK8F,aAAL,CAAmB,CAAnB,EAAsB7F,QAAvF,EAAiG,KAAjG;AACAM,IAAAA,OAAO,CAACsD,mBAAR,CAA4B,KAAKiC,aAAL,CAAmB,CAAnB,EAAsB9F,IAAlD,EAAwD,KAAK8F,aAAL,CAAmB,CAAnB,EAAsB7F,QAA9E,EAAwF,KAAxF;AACD,GAvRH;;AAAA,SAyRE6C,QAzRF,GAyRE,kBAAS0F,KAAT,EAAgB;AACd,QAAI,CAAC,KAAKjH,OAAV,EAAmB;AAEnB,QAAMqB,QAAiB,GAAG,KAAKxE,MAAL,CAAYuE,SAAZ,CAAsBC,QAAhD;AACAA,IAAAA,QAAQ,CAAC6F,OAAT,CAAiB,KAAKxC,OAAtB;;AACA,SAAKA,OAAL,CAAayC,QAAb,CAAsB,KAAKrE,MAA3B;;AACA,SAAK9E,UAAL,CAAgB0E,WAAhB,CAA4B,KAAKgC,OAAjC;;AAEA,QAAI,KAAKV,UAAL,IAAmB,KAAKkB,MAAL,KAAgB,KAAKZ,KAAL,CAAWgC,IAAlD,EAAwD;AACtD,WAAKc,UAAL,CAAgB,KAAKC,oBAAL,CAA0BJ,KAA1B,CAAhB;AACD;;AAED,SAAKjJ,UAAL,CAAgBgD,KAAhB,IAAyB,KAAK2D,eAAL,CAAqB3D,KAA9C;AACA,SAAKhD,UAAL,CAAgBiD,GAAhB,IAAuB,KAAK0D,eAAL,CAAqB1D,GAA5C;AAEA,SAAKjD,UAAL,CAAgBgD,KAAhB,GAAwBF,IAAI,CAACwG,GAAL,CAAS,KAAK5D,eAAd,EAA+B5C,IAAI,CAACyG,GAAL,CAAS,KAAK5D,eAAd,EAA+B,KAAK3F,UAAL,CAAgBgD,KAA/C,CAA/B,CAAxB;AACA,SAAKhD,UAAL,CAAgBiD,GAAhB,GAAsBH,IAAI,CAACwG,GAAL,CAAS,KAAK9D,aAAd,EAA6B1C,IAAI,CAACyG,GAAL,CAAS,KAAK9D,aAAd,EAA6B,KAAKzF,UAAL,CAAgBiD,GAA7C,CAA7B,CAAtB;;AACA,SAAKjD,UAAL,CAAgBwJ,QAAhB;;AAEA,QAAI,KAAK1C,MAAL,KAAgB,CAApB,EAAuB;AACrB,WAAKD,SAAL,GAAiB,KAAK7G,UAAL,CAAgByJ,MAAhB,IAA0B,KAAK3C,MAAL,GAAc,CAAxC,CAAjB;AACD;;AAED,SAAK9G,UAAL,CAAgByJ,MAAhB,IAA0B,KAAK5C,SAA/B;AACA,SAAK7G,UAAL,CAAgByJ,MAAhB,GAAyB3G,IAAI,CAACwG,GAAL,CAAS,KAAKtE,WAAd,EAA2BlC,IAAI,CAACyG,GAAL,CAAS,KAAKtE,WAAd,EAA2B,KAAKjF,UAAL,CAAgByJ,MAA3C,CAA3B,CAAzB;AAEA,SAAK3E,MAAL,CAAY3B,GAAZ,CAAgB,KAAK4D,UAArB;;AACA,SAAK/G,UAAL,CAAgBkD,SAAhB,CAA0B,KAAKwD,OAA/B;;AACA,SAAK5B,MAAL,CAAYoE,OAAZ,CAAoB,KAAKzC,SAAzB;;AACA,SAAKA,SAAL,CAAetD,GAAf,CAAmB,KAAKuD,OAAxB;;AAEA,QAAI,CAAC/H,OAAO,CAAC+K,MAAR,CAAe,KAAK7K,MAAL,CAAYuE,SAAZ,CAAsBC,QAArC,EAA+C,KAAKoD,SAApD,CAAL,EAAqE;AACnE,WAAK5H,MAAL,CAAYuE,SAAZ,CAAsBC,QAAtB,GAAiC,KAAKoD,SAAtC;AACA,WAAK5H,MAAL,CAAYuE,SAAZ,CAAsBE,MAAtB,CAA6B,KAAKwB,MAAlC,EAA0C,KAAKC,EAA/C;AACD;;AACD,QAAI,CAACpG,OAAO,CAAC+K,MAAR,CAAe,KAAK5E,MAApB,EAA4B,KAAK8C,UAAjC,CAAL,EAAmD;AACjD,WAAK/I,MAAL,CAAYuE,SAAZ,CAAsBE,MAAtB,CAA6B,KAAKwB,MAAlC,EAA0C,KAAKC,EAA/C;AACA,WAAKD,MAAL,CAAYoE,OAAZ,CAAoB,KAAKtB,UAAzB;AACD;;AAED,QAAI,KAAKxC,aAAL,KAAuB,IAA3B,EAAiC;AAC/B,WAAKwB,cAAL,CAAoB5D,KAApB,IAA6B,IAAI,KAAK6C,aAAtC;AACA,WAAKe,cAAL,CAAoB3D,GAApB,IAA2B,IAAI,KAAK4C,aAApC;AACA,WAAKgB,SAAL,IAAkB,IAAI,KAAKxB,UAA3B;;AAEA,UAAI,KAAK2B,UAAT,EAAqB;AACnB,aAAKL,eAAL,CAAqB3D,KAArB,GAA6B,KAAK4D,cAAL,CAAoB5D,KAAjD;AACA,aAAK2D,eAAL,CAAqB1D,GAArB,GAA2B,KAAK2D,cAAL,CAAoB3D,GAA/C;AACD,OAHD,MAGO;AACL,aAAK0D,eAAL,CAAqBgD,GAArB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B;AACD;AACF,KAXD,MAWO;AACL,WAAKhD,eAAL,CAAqBgD,GAArB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B;;AACA,WAAK9C,SAAL,GAAiB,CAAjB;AACD;;AAED,SAAKC,MAAL,GAAc,CAAd;;AACA,SAAKC,UAAL,CAAgBxC,QAAhB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B;AACD;AAED;AACF;AACA;AAvVA;;AAAA,SAwVE8E,oBAxVF,GAwVE,8BAAqBJ,KAArB,EAAoC;AAClC,WAAS,IAAInG,IAAI,CAACC,EAAV,GAAgB,KAAKkD,eAArB,GAAuC,IAAxC,GAAgDgD,KAAvD;AACD;AAED;AACF;AACA;AA9VA;;AAAA,SA+VEW,YA/VF,GA+VE,wBAAe;AACb,WAAO9G,IAAI,CAAC+G,GAAL,CAAS,IAAT,EAAe,KAAK/D,SAApB,CAAP;AACD;AAED;AACF;AACA;AACA;AAtWA;;AAAA,SAuWEsD,UAvWF,GAuWE,oBAAWU,MAAX,EAA2B;AACzB,SAAKnD,eAAL,CAAqB3D,KAArB,IAA8B8G,MAA9B;;AACA,QAAI,KAAK1E,aAAT,EAAwB;AACtB,WAAKwB,cAAL,CAAoB5D,KAApB,GAA4B,CAAC8G,MAA7B;AACD;AACF;AAED;AACF;AACA;AACA;AAjXA;;AAAA,SAkXEC,QAlXF,GAkXE,kBAASD,MAAT,EAAyB;AACvB,SAAKnD,eAAL,CAAqB1D,GAArB,IAA4B6G,MAA5B;;AACA,QAAI,KAAK1E,aAAT,EAAwB;AACtB,WAAKwB,cAAL,CAAoB3D,GAApB,GAA0B,CAAC6G,MAA3B;AACD;AACF;AAED;AACF;AACA;AA3XA;;AAAA,SA4XEE,OA5XF,GA4XE,iBAAQC,QAAR,EAA0BC,WAA1B,EAA+C;AAC7C,QAAM5L,CAAC,GAAG4L,WAAW,CAACC,QAAtB;;AACA,SAAKlD,KAAL,CAAW1C,QAAX,CAAoBjG,CAAC,CAAC,CAAD,CAArB,EAA0BA,CAAC,CAAC,CAAD,CAA3B,EAAgCA,CAAC,CAAC,CAAD,CAAjC;;AACA,SAAK2I,KAAL,CAAWpD,KAAX,CAAiBoG,QAAjB;;AACA,SAAKlD,UAAL,CAAgB5D,GAAhB,CAAoB,KAAK8D,KAAzB;AACD;AAED;AACF;AACA;AArYA;;AAAA,SAsYEmD,KAtYF,GAsYE,eAAMH,QAAN,EAAwBC,WAAxB,EAA6C;AAC3C,QAAM5L,CAAC,GAAG4L,WAAW,CAACC,QAAtB;;AACA,SAAKlD,KAAL,CAAW1C,QAAX,CAAoBjG,CAAC,CAAC,CAAD,CAArB,EAA0BA,CAAC,CAAC,CAAD,CAA3B,EAAgCA,CAAC,CAAC,CAAD,CAAjC;;AACA,SAAK2I,KAAL,CAAWpD,KAAX,CAAiBoG,QAAjB;;AACA,SAAKlD,UAAL,CAAgB5D,GAAhB,CAAoB,KAAK8D,KAAzB;AACD;AAED;AACF;AACA;AACA;AACA;AAjZA;;AAAA,SAkZEoD,GAlZF,GAkZE,aAAIC,MAAJ,EAAoBC,MAApB,EAAoC;AAClC,QAAMvJ,OAAO,GAAG,KAAKjC,UAAL,KAAoBwB,QAApB,GAA+B,KAAKxB,UAAL,CAAgBiK,IAA/C,GAAuD,KAAKjK,UAA5E,CADkC;;AAIlC,QAAMsE,QAAiB,GAAG,KAAKxE,MAAL,CAAYwE,QAAtC;AACAA,IAAAA,QAAQ,CAAC6F,OAAT,CAAiB,KAAKjC,KAAtB;;AACA,SAAKA,KAAL,CAAWkC,QAAX,CAAoB,KAAKrE,MAAzB;;AACA,QAAI0F,cAAc,GAAG,KAAKvD,KAAL,CAAWwD,MAAX,EAArB;;AAEAD,IAAAA,cAAc,IAAK,KAAK3F,GAAL,GAAW,CAAZ,IAAkB/B,IAAI,CAACC,EAAL,GAAU,GAA5B,CAAlB;AAEA,SAAKiH,OAAL,CAAa,CAAC,CAAD,GAAKM,MAAL,IAAeE,cAAc,GAAGxJ,OAAO,CAAC0J,YAAxC,CAAb,EAAoE,KAAK7L,MAAL,CAAYuE,SAAZ,CAAsB8G,WAA1F;AACA,SAAKE,KAAL,CAAW,IAAIG,MAAJ,IAAcC,cAAc,GAAGxJ,OAAO,CAAC0J,YAAvC,CAAX,EAAiE,KAAK7L,MAAL,CAAYuE,SAAZ,CAAsB8G,WAAvF;AACD;AAED;AACF;AACA;AAnaA;;AAAA,SAoaES,MApaF,GAoaE,gBAAOC,SAAP,EAAgC;AAC9B;AACA,SAAK9D,MAAL,IAAe8D,SAAf;AACD;AAED;AACF;AACA;AA3aA;;AAAA,SA4aEC,OA5aF,GA4aE,iBAAQD,SAAR,EAAiC;AAC/B;AACA,SAAK9D,MAAL,IAAe8D,SAAf;AACD;AAED;AACF;AACA;AAnbA;;AAAA,SAobEE,qBApbF,GAobE,+BAAsBxJ,KAAtB,EAA6B;AAC3B,SAAK6F,YAAL,CAAkB5C,QAAlB,CAA2BjD,KAAK,CAACQ,OAAjC,EAA0CR,KAAK,CAACS,OAAhD;AACD;AAED;AACF;AACA;AA1bA;;AAAA,SA2bEgJ,mBA3bF,GA2bE,6BAAoBzJ,KAApB,EAA2B;AACzB,SAAKmG,UAAL,CAAgBlD,QAAhB,CAAyBjD,KAAK,CAACQ,OAA/B,EAAwCR,KAAK,CAACS,OAA9C;AACD;AAED;AACF;AACA;AAjcA;;AAAA,SAkcEiJ,kBAlcF,GAkcE,4BAAmB1J,KAAnB,EAA0B;AACxB,SAAKgG,SAAL,CAAe/C,QAAf,CAAwBjD,KAAK,CAACQ,OAA9B,EAAuCR,KAAK,CAACS,OAA7C;AACD;AAED;AACF;AACA;AAxcA;;AAAA,SAycEkJ,qBAzcF,GAycE,+BAAsB3J,KAAtB,EAA6B;AAC3B,SAAK8F,UAAL,CAAgB7C,QAAhB,CAAyBjD,KAAK,CAACQ,OAA/B,EAAwCR,KAAK,CAACS,OAA9C;;AACAsG,IAAAA,OAAO,CAACc,QAAR,CAAiB,KAAK/B,UAAtB,EAAkC,KAAKD,YAAvC,EAAqD,KAAKE,YAA1D;AAEA,QAAMrG,OAAO,GAAG,KAAKjC,UAAL,KAAoBwB,QAApB,GAA+BA,QAAQ,CAACyI,IAAxC,GAAgD,KAAKjK,UAArE;AAEA,SAAKqK,UAAL,CAAgB,IAAItG,IAAI,CAACC,EAAT,IAAe,KAAKsE,YAAL,CAAkBrD,CAAlB,GAAsBhD,OAAO,CAACkK,WAA7C,IAA4D,KAAKjM,WAAjF;AACA,SAAK8K,QAAL,CAAc,IAAIjH,IAAI,CAACC,EAAT,IAAe,KAAKsE,YAAL,CAAkBvD,CAAlB,GAAsB9C,OAAO,CAAC0J,YAA7C,IAA6D,KAAKzL,WAAhF;;AAEA,SAAKmI,UAAL,CAAgB8B,OAAhB,CAAwB,KAAK/B,YAA7B;AACD;AAED;AACF;AACA;AAvdA;;AAAA,SAwdEgE,mBAxdF,GAwdE,6BAAoB7J,KAApB,EAA2B;AACzB,SAAKoG,QAAL,CAAcnD,QAAd,CAAuBjD,KAAK,CAACQ,OAA7B,EAAsCR,KAAK,CAACS,OAA5C;;AACAsG,IAAAA,OAAO,CAACc,QAAR,CAAiB,KAAKzB,QAAtB,EAAgC,KAAKD,UAArC,EAAiD,KAAKE,UAAtD;;AAEA,QAAI,KAAKA,UAAL,CAAgB7D,CAAhB,GAAoB,CAAxB,EAA2B;AACzB,WAAK+G,OAAL,CAAa,KAAKjB,YAAL,EAAb;AACD,KAFD,MAEO,IAAI,KAAKjC,UAAL,CAAgB7D,CAAhB,GAAoB,CAAxB,EAA2B;AAChC,WAAK6G,MAAL,CAAY,KAAKf,YAAL,EAAZ;AACD;;AAED,SAAKlC,QAAL,CAAcwB,OAAd,CAAsB,KAAKzB,UAA3B;AACD;AAED;AACF;AACA;AAveA;;AAAA,SAweE2D,kBAxeF,GAweE,4BAAmB9J,KAAnB,EAA4C;AAC1C,SAAKiG,OAAL,CAAahD,QAAb,CAAsBjD,KAAK,CAACQ,OAA5B,EAAqCR,KAAK,CAACS,OAA3C;;AACAsG,IAAAA,OAAO,CAACc,QAAR,CAAiB,KAAK5B,OAAtB,EAA+B,KAAKD,SAApC,EAA+C,KAAKE,SAApD;AAEA,SAAK6C,GAAL,CAAS,KAAK7C,SAAL,CAAexD,CAAxB,EAA2B,KAAKwD,SAAL,CAAe1D,CAA1C;;AAEA,SAAKyD,OAAL,CAAa2B,OAAb,CAAqB,KAAK5B,SAA1B;AACD;AAED;AACF;AACA;AAnfA;;AAAA,SAofE+D,gBApfF,GAofE,0BAAiB/J,KAAjB,EAA+C;AAC7C,QAAIA,KAAK,CAACiJ,MAAN,GAAe,CAAnB,EAAsB;AACpB,WAAKI,MAAL,CAAY,KAAKf,YAAL,EAAZ;AACD,KAFD,MAEO,IAAItI,KAAK,CAACiJ,MAAN,GAAe,CAAnB,EAAsB;AAC3B,WAAKM,OAAL,CAAa,KAAKjB,YAAL,EAAb;AACD;AACF;AAED;AACF;AACA;AA9fA;;AAAA,SA+fE0B,aA/fF,GA+fE,uBAAchK,KAAd,EAAoC;AAClC,YAAQA,KAAK,CAACI,OAAd;AACE,WAAK,KAAKyE,IAAL,CAAU4B,EAAf;AACE,aAAKsC,GAAL,CAAS,CAAT,EAAY,KAAK9E,WAAjB;AACA;;AACF,WAAK,KAAKY,IAAL,CAAU8B,MAAf;AACE,aAAKoC,GAAL,CAAS,CAAT,EAAY,CAAC,KAAK9E,WAAlB;AACA;;AACF,WAAK,KAAKY,IAAL,CAAU2B,IAAf;AACE,aAAKuC,GAAL,CAAS,KAAK9E,WAAd,EAA2B,CAA3B;AACA;;AACF,WAAK,KAAKY,IAAL,CAAU6B,KAAf;AACE,aAAKqC,GAAL,CAAS,CAAC,KAAK9E,WAAf,EAA4B,CAA5B;AACA;AAZJ;AAcD;AAED;AACF;AACA;AAlhBA;;AAAA,SAmhBEgG,sBAnhBF,GAmhBE,gCAAuBjK,KAAvB,EAA0C;AACxC,SAAK6F,YAAL,CAAkB5C,QAAlB,CAA2BjD,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBC,KAA5C,EAAmDnK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBE,KAApE;AACD;AAED;AACF;AACA;AAzhBA;;AAAA,SA0hBEC,oBA1hBF,GA0hBE,8BAAqBrK,KAArB,EAAwC;AACtC,QAAMsK,EAAE,GAAGtK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBC,KAAjB,GAAyBnK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBC,KAArD;AACA,QAAMI,EAAE,GAAGvK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBE,KAAjB,GAAyBpK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBE,KAArD;AAEA,QAAMzB,QAAQ,GAAGnH,IAAI,CAACgJ,IAAL,CAAUF,EAAE,GAAGA,EAAL,GAAUC,EAAE,GAAGA,EAAzB,CAAjB;;AAEA,SAAKpE,UAAL,CAAgBlD,QAAhB,CAAyB,CAAzB,EAA4B0F,QAA5B;AACD;AAED;AACF;AACA;AAriBA;;AAAA,SAsiBE8B,mBAtiBF,GAsiBE,6BAAoBzK,KAApB,EAAuC;AACrC,SAAKgG,SAAL,CAAe/C,QAAf,CAAwBjD,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBC,KAAzC,EAAgDnK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBE,KAAjE;AACD;AAED;AACF;AACA;AA5iBA;;AAAA,SA6iBEM,qBA7iBF,GA6iBE,+BAAsB1K,KAAtB,EAAyC;AACvC,SAAK8F,UAAL,CAAgB7C,QAAhB,CAAyBjD,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBC,KAA1C,EAAiDnK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBE,KAAlE;;AACArD,IAAAA,OAAO,CAACc,QAAR,CAAiB,KAAK/B,UAAtB,EAAkC,KAAKD,YAAvC,EAAqD,KAAKE,YAA1D;AAEA,QAAMrG,OAAO,GAAG,KAAKjC,UAAL,KAAoBwB,QAApB,GAA+B,KAAKxB,UAAL,CAAgBiK,IAA/C,GAAuD,KAAKjK,UAA5E;AAEA,SAAKqK,UAAL,CAAkB,IAAItG,IAAI,CAACC,EAAT,GAAc,KAAKsE,YAAL,CAAkBrD,CAAjC,GAAsChD,OAAO,CAACkK,WAA/C,GAA8D,KAAKjM,WAAnF;AACA,SAAK8K,QAAL,CAAgB,IAAIjH,IAAI,CAACC,EAAT,GAAc,KAAKsE,YAAL,CAAkBvD,CAAjC,GAAsC9C,OAAO,CAAC0J,YAA/C,GAA+D,KAAKzL,WAAlF;;AAEA,SAAKmI,UAAL,CAAgB8B,OAAhB,CAAwB,KAAK/B,YAA7B;AACD;AAED;AACF;AACA;AA3jBA;;AAAA,SA4jBE8E,mBA5jBF,GA4jBE,6BAAoB3K,KAApB,EAA2B;AACzB,QAAMsK,EAAE,GAAGtK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBC,KAAjB,GAAyBnK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBC,KAArD;AACA,QAAMI,EAAE,GAAGvK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBE,KAAjB,GAAyBpK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBE,KAArD;AAEA,QAAMzB,QAAQ,GAAGnH,IAAI,CAACgJ,IAAL,CAAUF,EAAE,GAAGA,EAAL,GAAUC,EAAE,GAAGA,EAAzB,CAAjB;;AAEA,SAAKnE,QAAL,CAAcnD,QAAd,CAAuB,CAAvB,EAA0B0F,QAA1B;;AAEA5B,IAAAA,OAAO,CAACc,QAAR,CAAiB,KAAKzB,QAAtB,EAAgC,KAAKD,UAArC,EAAiD,KAAKE,UAAtD;;AAEA,QAAI,KAAKA,UAAL,CAAgB7D,CAAhB,GAAoB,CAAxB,EAA2B;AACzB,WAAK6G,MAAL,CAAY,KAAKf,YAAL,EAAZ;AACD,KAFD,MAEO,IAAI,KAAKjC,UAAL,CAAgB7D,CAAhB,GAAoB,CAAxB,EAA2B;AAChC,WAAK+G,OAAL,CAAa,KAAKjB,YAAL,EAAb;AACD;;AAED,SAAKlC,QAAL,CAAcwB,OAAd,CAAsB,KAAKzB,UAA3B;AACD;AAED;AACF;AACA;AAjlBA;;AAAA,SAklBEyE,kBAllBF,GAklBE,4BAAmB5K,KAAnB,EAAsC;AACpC,SAAKiG,OAAL,CAAahD,QAAb,CAAsBjD,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBC,KAAvC,EAA8CnK,KAAK,CAACkK,OAAN,CAAc,CAAd,EAAiBE,KAA/D;;AAEArD,IAAAA,OAAO,CAACc,QAAR,CAAiB,KAAK5B,OAAtB,EAA+B,KAAKD,SAApC,EAA+C,KAAKE,SAApD;AAEA,SAAK6C,GAAL,CAAS,KAAK7C,SAAL,CAAexD,CAAxB,EAA2B,KAAKwD,SAAL,CAAe1D,CAA1C;;AAEA,SAAKyD,OAAL,CAAa2B,OAAb,CAAqB,KAAK5B,SAA1B;AACD;AAED;AACF;AACA;AA9lBA;;AAAA,SA+lBEzG,WA/lBF,GA+lBE,qBAAYS,KAAZ,EAA+B;AAC7B,QAAI,KAAKU,OAAL,KAAiB,KAArB,EAA4B;AAE5BV,IAAAA,KAAK,CAACC,cAAN;AAEA,SAAKyF,UAAL,GAAkB,KAAlB;;AAEA,YAAQ1F,KAAK,CAAC6K,MAAd;AACE,WAAK,KAAK/F,YAAL,CAAkB8B,KAAvB;AACE,YAAI,KAAK5C,YAAL,KAAsB,KAA1B,EAAiC;AAEjC,aAAKwF,qBAAL,CAA2BxJ,KAA3B;AACA,aAAK4F,MAAL,GAAc,KAAKZ,KAAL,CAAWiC,MAAzB;AACA;;AAEF,WAAK,KAAKnC,YAAL,CAAkB+B,IAAvB;AACE,YAAI,KAAKvC,UAAL,KAAoB,KAAxB,EAA+B;AAE/B,aAAKmF,mBAAL,CAAyBzJ,KAAzB;AACA,aAAK4F,MAAL,GAAc,KAAKZ,KAAL,CAAW6B,IAAzB;AACA;;AAEF,WAAK,KAAK/B,YAAL,CAAkBgC,GAAvB;AACE,YAAI,KAAKrC,SAAL,KAAmB,KAAvB,EAA8B;AAE9B,aAAKiF,kBAAL,CAAwB1J,KAAxB;AACA,aAAK4F,MAAL,GAAc,KAAKZ,KAAL,CAAW8B,GAAzB;AACA;AApBJ;;AAuBA,QAAI,KAAKlB,MAAL,KAAgB,KAAKZ,KAAL,CAAWgC,IAA/B,EAAqC;AACnC,UAAMtH,OAAO,GAAG,KAAKjC,UAAL,KAAoBwB,QAApB,GAA+B,KAAKxB,UAAL,CAAgBiK,IAA/C,GAAsD,KAAKjK,UAA3E;AACA,WAAKD,WAAL,CAAiBsF,gBAAjB,CAAkC,KAAKmC,aAAL,CAAmB,CAAnB,EAAsB9F,IAAxD,EAA8D,KAAK8F,aAAL,CAAmB,CAAnB,EAAsB7F,QAApF,EAA8F,KAA9F;AACAM,MAAAA,OAAO,CAACoD,gBAAR,CAAyB,KAAKmC,aAAL,CAAmB,CAAnB,EAAsB9F,IAA/C,EAAqD,KAAK8F,aAAL,CAAmB,CAAnB,EAAsB7F,QAA3E,EAAqF,KAArF;AACD;AACF;AAED;AACF;AACA;AAtoBA;;AAAA,SAuoBEC,WAvoBF,GAuoBE,qBAAYW,KAAZ,EAA+B;AAC7B,QAAI,KAAKU,OAAL,KAAiB,KAArB,EAA4B;AAE5BV,IAAAA,KAAK,CAACC,cAAN;;AAEA,YAAQ,KAAK2F,MAAb;AACE,WAAK,KAAKZ,KAAL,CAAWiC,MAAhB;AACE,YAAI,KAAKjD,YAAL,KAAsB,KAA1B,EAAiC;AAEjC,aAAK2F,qBAAL,CAA2B3J,KAA3B;AACA;;AAEF,WAAK,KAAKgF,KAAL,CAAW6B,IAAhB;AACE,YAAI,KAAKvC,UAAL,KAAoB,KAAxB,EAA+B;AAE/B,aAAKuF,mBAAL,CAAyB7J,KAAzB;AACA;;AAEF,WAAK,KAAKgF,KAAL,CAAW8B,GAAhB;AACE,YAAI,KAAKrC,SAAL,KAAmB,KAAvB,EAA8B;AAE9B,aAAKqF,kBAAL,CAAwB9J,KAAxB;AACA;AAjBJ;AAmBD;AAED;AACF;AACA;AAnqBA;;AAAA,SAoqBER,SApqBF,GAoqBE,qBAAY;AAAA;;AACV,QAAI,KAAKkB,OAAL,KAAiB,KAArB,EAA4B;AAE5B,SAAKgF,UAAL,GAAkB,IAAlB;AAEA,SAAKT,aAAL,CAAmBrC,OAAnB,CAA2B,UAACC,GAAD,EAAS;AAClC,UAAMnD,OAAO,GAAG,MAAI,CAACjC,UAAL,KAAoBwB,QAApB,GAA+B,MAAI,CAACxB,UAAL,CAAgBiK,IAA/C,GAAsD,MAAI,CAACjK,UAA3E;AACAiC,MAAAA,OAAO,CAACsD,mBAAR,CAA4BH,GAAG,CAAC1D,IAAhC,EAAsC0D,GAAG,CAACzD,QAA1C,EAAoD,KAApD;;AACA,MAAA,MAAI,CAAC5B,WAAL,CAAiBwF,mBAAjB,CAAqCH,GAAG,CAAC1D,IAAzC,EAA+C0D,GAAG,CAACzD,QAAnD,EAA6D,KAA7D;AACD,KAJD;AAMA,SAAKwG,MAAL,GAAc,KAAKZ,KAAL,CAAWgC,IAAzB;AACD;AAED;AACF;AACA;AAprBA;;AAAA,SAqrBEK,YArrBF,GAqrBE,sBAAarH,KAAb,EAAqC;AACnC,QACE,KAAKU,OAAL,KAAiB,KAAjB,IACA,KAAK4D,UAAL,KAAoB,KADpB,IAEC,KAAKsB,MAAL,KAAgB,KAAKZ,KAAL,CAAWgC,IAA3B,IAAmC,KAAKpB,MAAL,KAAgB,KAAKZ,KAAL,CAAWiC,MAHjE,EAKE;AAEFjH,IAAAA,KAAK,CAACC,cAAN;AACAD,IAAAA,KAAK,CAACK,eAAN;AAEA,SAAK0J,gBAAL,CAAsB/J,KAAtB;AACD;AAED;AACF;AACA;AArsBA;;AAAA,SAssBEP,SAtsBF,GAssBE,mBAAUO,KAAV,EAAgC;AAC9B,QAAI,KAAKU,OAAL,KAAiB,KAAjB,IAA0B,KAAKkE,UAAL,KAAoB,KAA9C,IAAuD,KAAKH,SAAL,KAAmB,KAA9E,EAAqF;AAErF,SAAKuF,aAAL,CAAmBhK,KAAnB;AACD;AAED;AACF;AACA;AA9sBA;;AAAA,SA+sBEsH,YA/sBF,GA+sBE,sBAAatH,KAAb,EAAgC;AAC9B,QAAI,KAAKU,OAAL,KAAiB,KAArB,EAA4B;AAE5B,SAAKgF,UAAL,GAAkB,KAAlB;;AAEA,YAAQ1F,KAAK,CAACkK,OAAN,CAAcf,MAAtB;AACE,WAAK,KAAKpE,YAAL,CAAkB6B,KAAvB;AACE,YAAI,KAAK5C,YAAL,KAAsB,KAA1B,EAAiC;AAEjC,aAAKiG,sBAAL,CAA4BjK,KAA5B;AACA,aAAK4F,MAAL,GAAc,KAAKZ,KAAL,CAAWkC,YAAzB;AAEA;;AAEF,WAAK,KAAKnC,YAAL,CAAkB8B,IAAvB;AACE,YAAI,KAAKvC,UAAL,KAAoB,KAAxB,EAA+B;AAE/B,aAAK+F,oBAAL,CAA0BrK,KAA1B;AACA,aAAK4F,MAAL,GAAc,KAAKZ,KAAL,CAAWmC,UAAzB;AAEA;;AAEF,WAAK,KAAKpC,YAAL,CAAkB+B,GAAvB;AACE,YAAI,KAAKrC,SAAL,KAAmB,KAAvB,EAA8B;AAE9B,aAAKgG,mBAAL,CAAyBzK,KAAzB;AACA,aAAK4F,MAAL,GAAc,KAAKZ,KAAL,CAAWoC,SAAzB;AAEA;;AAEF;AACE,aAAKxB,MAAL,GAAc,KAAKZ,KAAL,CAAWgC,IAAzB;AA1BJ;AA4BD;AAED;AACF;AACA;AApvBA;;AAAA,SAqvBEO,WArvBF,GAqvBE,qBAAYvH,KAAZ,EAA+B;AAC7B,QAAI,KAAKU,OAAL,KAAiB,KAArB,EAA4B;AAE5BV,IAAAA,KAAK,CAACC,cAAN;AACAD,IAAAA,KAAK,CAACK,eAAN;;AAEA,YAAQL,KAAK,CAACkK,OAAN,CAAcf,MAAtB;AACE,WAAK,KAAKpE,YAAL,CAAkB6B,KAAvB;AACE,YAAI,KAAK5C,YAAL,KAAsB,KAA1B,EAAiC;AACjC,YAAI,KAAK4B,MAAL,KAAgB,KAAKZ,KAAL,CAAWkC,YAA/B,EAA6C;AAC7C,aAAKwD,qBAAL,CAA2B1K,KAA3B;AAEA;;AAEF,WAAK,KAAK+E,YAAL,CAAkB8B,IAAvB;AACE,YAAI,KAAKvC,UAAL,KAAoB,KAAxB,EAA+B;AAC/B,YAAI,KAAKsB,MAAL,KAAgB,KAAKZ,KAAL,CAAWmC,UAA/B,EAA2C;AAC3C,aAAKwD,mBAAL,CAAyB3K,KAAzB;AAEA;;AAEF,WAAK,KAAK+E,YAAL,CAAkB+B,GAAvB;AACE,YAAI,KAAKrC,SAAL,KAAmB,KAAvB,EAA8B;AAC9B,YAAI,KAAKmB,MAAL,KAAgB,KAAKZ,KAAL,CAAWoC,SAA/B,EAA0C;AAC1C,aAAKwD,kBAAL,CAAwB5K,KAAxB;AAEA;;AAEF;AACE,aAAK4F,MAAL,GAAc,KAAKZ,KAAL,CAAWgC,IAAzB;AAvBJ;AAyBD;AAED;AACF;AACA;AAxxBA;;AAAA,SAyxBEQ,UAzxBF,GAyxBE,sBAAa;AACX,QAAI,KAAK9G,OAAL,KAAiB,KAArB,EAA4B;AAE5B,SAAKgF,UAAL,GAAkB,IAAlB;AACA,SAAKE,MAAL,GAAc,KAAKZ,KAAL,CAAWgC,IAAzB;AACD;AAED;AACF;AACA;AAlyBA;;AAAA,SAmyBEnH,aAnyBF,GAmyBE,uBAAcG,KAAd,EAAqB;AACnB,QAAI,KAAKU,OAAL,KAAiB,KAArB,EAA4B;AAC5BV,IAAAA,KAAK,CAACC,cAAN;AACD,GAtyBH;;AAAA;AAAA,EAAkCoD,MAAlC;;;;"}